!function(t,e){if("object"==typeof exports&&"object"==typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var n=e();for(var r in n)("object"==typeof exports?exports:t)[r]=n[r]}}(window,function(){return function(t){var e={};function n(r){if(e[r])return e[r].exports;var i=e[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:r})},n.r=function(t){Object.defineProperty(t,"__esModule",{value:!0})},n.n=function(t){var e=t&&t.t?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=16)}([function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0});var r=n(1),i=n(7),o=n(6);e.u="undefined"!=typeof window&&window.u?window.u:"undefined"!=typeof global&&global.u?global.u:r.u,e.stopWords=["a","about","after","all","also","am","an","and","andor","another","any","are","as","at","be","because","been","before","being","between","both","but","by","came","can","come","could","did","do","each","for","from","get","got","had","has","have","he","her","here","him","himself","his","how","i","if","in","into","is","it","like","make","many","me","might","more","most","much","must","my","never","now","of","on","only","or","other","our","out","over","said","same","see","should","since","some","still","such","take","than","that","the","their","them","then","there","these","they","this","those","through","to","too","under","up","very","was","way","we","well","were","what","where","which","while","who","with","would","you","your"],e.f=function(t){return t?JSON.parse(JSON.stringify(t)):null},e.fastCHAIN=function(t,n){return new e.u(function(e,i){if(t&&t.length){var o=[],s=!1,a=function(){if(o.length<t.length)n(t[o.length],o.length,function(t){o.push(t),o.length%100==0?r.setFast(a):a()},function(t){s=!0,i(t)});else{if(s)return;e(o)}};a()}else e([])})},e.fastRACE=function(t,n){return new e.u(function(e,r){if(t&&t.length){var i=!1,o=0,s=function(){o<t.length&&(n(t[o],o,function(t){i||(i=!0,e([t]))},function(t){i||(i=!0,r(t))}),o++,s())};s()}else e([])})},e.fastALL=function(t,n){return e.u.all((t||[]).map(function(t,r){return new e.u(function(e,i){n(t,r,e,i)})}))};var s="undefined"==typeof window?"":navigator.userAgent||"";e.isSafari=0!==s.length&&(/^((?!chrome|android).)*safari/i.test(s)||/iPad|iPhone|iPod/.test(s)&&!window.MSStream),e.isMSBrowser=0!==s.length&&(s.indexOf("MSIE ")>0||s.indexOf("Trident/")>0||s.indexOf("Edge/")>0),e.isAndroid=/Android/.test(s),e.random16Bits=function(){if("undefined"==typeof crypto)return Math.round(Math.random()*Math.pow(2,16));if(crypto.getRandomValues){var t=new Uint16Array(1);return crypto.getRandomValues(t),t[0]}return"undefined"!=typeof global&&global.a.randomBytes?global.a.randomBytes(2).reduce(function(t,e){return e*t}):Math.round(Math.random()*Math.pow(2,16))},e.tokenizer=function(t,n,r,s,a){var u=function(t){return!t||1===String(t).length||-1!==e.stopWords.indexOf(t)},c=(s||"").toLowerCase().replace(/(\d+)\/(\d+)|(?:\d+(?:,\d+)*|\d+)(?:\.\d+)?/gim,function(t,e,n){return e||n?(parseInt(e)/parseInt(n)).toFixed(a||4):parseFloat(t.replace(/\,/gim,"")).toFixed(a||4)}).replace(/\-|\_|\[|\]|\(|\)|\{|\}|\r?\n|\r|\t/gim," ").replace(/[^\w\s]|(\d\.)/gim,"$1").replace(/\s+/g," ").split(" ");switch(r[1]){case"english":return c.map(function(t,e){return{i:e,o:t,w:isNaN(t)?u(t)?"":i(o(t)):t}});case"english-stem":return c.map(function(t,e){return{i:e,o:t,w:isNaN(t)?u(t)?"":o(t):t}});case"english-meta":return c.map(function(t,e){return{i:e,o:t,w:isNaN(t)?u(t)?"":i(t):t}})}return c.map(function(t,e){return{o:t,w:t,i:e}})},e.timeid=function(t){for(var n=Math.round((new Date).getTime()/(t?1:1e3)).toString();n.length<(t?13:10);)n="0"+n;return n+"-"+(e.random16Bits()+e.random16Bits()).toString(16)},e.intersect=function(t,e){return!(!t||!e)&&!(!t.length||!e.length)&&(t||[]).filter(function(t){return-1!==(e||[]).indexOf(t)}).length>0},e.uuid=function(){var t,n,r="";return[r,r,r,r,r,r,r,r].reduce(function(i,o,s){for(t=e.random16Bits(),n=3===s?4:4===s?(t%16&3|8).toString(16):r,t=t.toString(16);t.length<4;)t="0"+t;return i+([2,3,4,5].indexOf(s)>-1?"-":r)+(n+t).slice(0,4)},r)},e.hash=function(t){for(var e=5381,n=t.length;n;)e=33*e^t.charCodeAt(--n);return(e>>>0).toString(16)};var a={int:function(t){return t},uuid:e.uuid,timeId:function(){return e.timeid()},timeIdms:function(){return e.timeid(!0)}};e.generateID=function(t,e){return a[t]?a[t](e||1):""},e.cleanArgs=function(t,n){for(var r={},i=t.length;i--;){var o=t[i].split(":");o.length>1?r[o[0]]=e.cast(o[1],n[o[0]]||void 0):r[o[0]]=n[o[0]]||void 0}return r},e.isObject=function(t){return"[object Object]"===Object.prototype.toString.call(t)},e.cast=function(t,n){if("any"===t||"blob"===t)return n;var r=typeof n;if("undefined"===r||null===n)return n;var i={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;","`":"&#x60;","=":"&#x3D;"},o=function(t,n){switch(t){case"safestr":return o("string",n).replace(/[&<>"'`=\/]/gim,function(t){return i[t]});case"int":return"number"!==r||n%1!=0?parseInt(n||0):n;case"number":case"float":return"number"!==r?parseFloat(n||0):n;case"any[]":case"array":return Array.isArray(n)?n:[];case"uuid":case"timeId":case"timeIdms":case"string":return"string"!==r?String(n):n;case"object":case"obj":case"map":return e.isObject(n)?n:{};case"boolean":case"bool":return!0===n}return n},s=o(String(t||"").toLowerCase(),n);if(-1!==t.indexOf("[]")){var a=t.slice(0,t.lastIndexOf("[]"));return(n||[]).map(function(t){return e.cast(a,t)})}return void 0!==s?["int","float","number"].indexOf(t)>-1&&isNaN(s)?0:s:void 0},e.binarySearch=function(t,n,r,i){var o=r||0,s=i||t.length;if(t[o]>n)return o;if(t[s]<n)return s+1;var a=Math.floor((o+s)/2);return n===t[a]?a:s-1===o?s:n>t[a]?e.binarySearch(t,n,a,s):n<t[a]?e.binarySearch(t,n,o,a):s},e.removeDuplicates=function(t){if(!t.length)return[];for(var e=[t[0]],n=1;n<t.length;n++)t[n]!==t[n-1]&&e.push(t[n]);return e},e.deepFreeze=function(t){return Object.getOwnPropertyNames(t||{}).forEach(function(n){var r=t[n];"object"==typeof r&&null!==r&&(t[n]=e.deepFreeze(r))}),Object.freeze(t)},e.crowDistance=function(t,e,n,r,i){void 0===i&&(i=6371);var o=function(t){return t*(Math.PI/180)},s=o(n-t),a=o(r-e),u=Math.sin(s/2)*Math.sin(s/2)+Math.cos(o(t))*Math.cos(o(n))*Math.sin(a/2)*Math.sin(a/2);return i*(2*Math.atan2(Math.sqrt(u),Math.sqrt(1-u)))};var u={};e.objQuery=function(t,e,n){var r=function(t,e,n){return t[e]&&n?r(t,e+1,n[t[e]]):n},i=t+(n?"1":"0");if(u[i])return r(u[i],0,e);var o=[];if(o=t.indexOf("[")>-1?[].concat.apply([],t.split(".").map(function(t){return t.match(/([^\[]+)|\[([^\]]+)\]\[/gim)||t})).map(function(t){return t.replace(/\[|\]/gim,"")}):t.split("."),n){var s=o.shift()+"."+o.shift();o.unshift(s)}return u[i]=o,r(u[i],0,e)}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=0,i={},o=Array.prototype.slice,s="undefined"!=typeof window&&window.setImmediate?window.setImmediate:!("undefined"==typeof global||!global.setImmediate)&&global.setImmediate,a="undefined"!=typeof window&&window.postMessage&&window.addEventListener,u=function(t){return t[0].apply(null,o.call(t,1))};a&&window.addEventListener("message",function(t){var e,n=t.data;"string"==typeof n&&0===n.indexOf("setMsg")&&(e=i[n])&&(delete i[n],u(e))});e.setFast=s?function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];s(function(){u(t)})}:a?function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=r++,o="setMsg"+n;return i[o]=t,window.postMessage(o,"*"),n}:function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];setTimeout(function(){u(t)},0)};var c=function(){},f=["R"],h=["F"],l=["P"],d=function(){function t(t){this.h=l,this.v=[],this.y=void 0,t!==c&&m(this,t)}return t.doPolyFill=function(){"undefined"!=typeof global&&(global.u||(global.u=this)),"undefined"!=typeof window&&(window.u||(window.u=this))},t.prototype.catch=function(t){return this.then(function(){},t)},t.prototype.then=function(e,n){if("function"!=typeof e&&this.h===h||"function"!=typeof n&&this.h===f)return this;var r=new t(c);return this.h!==l?y(r,this.h===h?e:n,this.y):this.v.push(new p(r,e,n)),r},t.resolve=function(e){return e instanceof this?e:g.b(new t(c),e)},t.reject=function(e){return g.S(new t(c),e)},t.all=function(e){return new t(function(t,n){var r=[];if(e.length)for(var i=function(n,i,o){void 0!==o?r.push(o):r.push(i),r.length==e.length&&t(r)},o=function(t){e[t].then(function(t){i(0,t,void 0)}).catch(function(t){i(0,void 0,t)})},s=0;s<e.length;s++)o(s);else t([])})},t.race=function(e){var n,r=e.length,i=!1,o=-1,s=new t(c);if(!1!==Array.isArray(e))return this.reject(new TypeError);if(!r)return this.resolve([]);for(;++o<r;)n=e[o],this.resolve(n).then(function(t){i||(i=!0,g.b(s,t))},function(t){i||(i=!0,g.S(s,t))});return s},t}();e.u=d;var p=function(){function t(t,e,n){this.T=t,"function"==typeof e&&(this.O=e,this.k=this.M),"function"==typeof n&&(this.j=n,this._=this.I)}return t.prototype.k=function(t){g.b(this.T,t)},t.prototype.M=function(t){y(this.T,this.O,t)},t.prototype._=function(t){g.S(this.T,t)},t.prototype.I=function(t){y(this.T,this.j,t)},t}();function y(t,n,r){e.setFast(function(){var e;try{e=n.apply(null,r)}catch(e){return g.S(t,e)}return e===t?g.S(t,new TypeError):g.b(t,e),null})}e.R=p;var g=function(){function t(){}return t.b=function(e,n){var r=w(v,n),i=r.N,o=-1,s=e.v.length;if("error"===r.A)return t.S(e,r.N);if(i)m(e,i);else for(e.h=h,e.y=n;++o<s;)e.v[o].k(n);return e},t.S=function(t,e){t.h=f,t.y=e;for(var n=-1,r=t.v.length;++n<r;)t.v[n]._(e);return t},t}();function v(t){var e=t&&t.then;return!t||"object"!=typeof t&&"function"!=typeof t||"function"!=typeof e?null:function(){e.apply(t,arguments)}}function m(t,e){var n=!1;function r(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];n||(n=!0,g.S(t,e))}function i(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];n||(n=!0,g.b(t,e))}var o=w(function(){e(i,r)});"error"===o.A&&r(o.N)}function w(t,e){var n={A:null,N:null};try{n.N=t(e),n.A="success"}catch(t){n.A="error",n.N=t}return n}},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0});var r=n(0),i=function(){function t(){this.x=[],this.P={},this.ai=1,this.sortIndex=!0,this.doAI=!1}return t.prototype.clone=function(e){this.D&&!e&&this.D(this.F,"drop",null);var n=new t;return n.doAI=this.doAI,n.ai=this.ai,n.sortIndex=this.sortIndex,n.D=this.D,n.F=this.F,n.pkType=this.pkType,e&&this.set([]),n},t.prototype.onChange=function(t,e){this.F=t,this.D=e},t.prototype.set=function(t){var e=this;this.x=t||[],this.P={},this.x.forEach(function(t,n){e.P[String(t)]=!0}),this.doAI&&this.x.length&&(this.ai=this.x[this.x.length-1]+1)},t.prototype.getLocation=function(t,e){var n=this.indexOf(t);return-1!==n?n:this.sortIndex?r.binarySearch(this.x,t,e):r.binarySearch(this.x.sort(function(t,e){return t>e?1:-1}),t,e)},t.prototype.add=function(t,e){if(!this.P[String(t)])if(this.D&&!e&&this.D(this.F,"add",t),this.P[String(t)]=!0,e&&-1!==["number","int","float"].indexOf(this.pkType)&&(t=parseFloat(t)),this.doAI)this.ai++,this.x.push(t);else if(this.sortIndex){var n=r.binarySearch(this.x,t);this.x.splice(n,0,t)}else this.x.push(t)},t.prototype.keys=function(){return this.x},t.prototype.exists=function(t){return!!this.P[String(t)]},t.prototype.indexOf=function(t){return this.P[String(t)]?this.sortIndex?r.binarySearch(this.x,t):this.x.indexOf(t):-1},t.prototype.remove=function(t,e){if(this.D&&!e&&this.D(this.F,"rm",t),e&&-1!==["number","int","float"].indexOf(this.pkType)&&(t=parseFloat(t)),this.P[String(t)]){var n=this.indexOf(t);this.P[String(t)]=!1,this.x.splice(n,1)}},t}();e.DatabaseIndex=i,e.syncPeerIndex=function(t,e){t.peerMode&&(Object.keys(e).forEach(function(n){e[n].onChange(n,function(e,n,i){t.peers.filter(function(e){return e!==t.pid}).forEach(function(t){localStorage.setItem(t+"::"+r.random16Bits().toString(16),n+","+e+","+(i||""))})})}),window.addEventListener("storage",function(n){if(n.key&&-1!==n.key.indexOf(t.pid+"::")){var r=(n.newValue||"").split(",");switch(localStorage.removeItem(n.key),r[0]){case"rm":e[r[1]].remove(r[2],!0);break;case"add":e[r[1]].add(r[2],!0);break;case"drop":e[r[1]].clone(!0)}}}))}},function(t,e,n){var r=this&&this.J||Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t};Object.defineProperty(e,"__esModule",{value:!0});var i=n(1),o=n(0),s=n(2),a=function(){function t(t){this.$={},this.L={},this.H=1e3*(t||0)*1e3}return t.prototype.setID=function(t){this.C=t},t.prototype.connect=function(t){var e=this;this.B=window.openDatabase(this.C,"1.0",this.C,this.H||o.isAndroid?5e6:1),o.fastALL(Object.keys(this.$),function(t,n,r){e.K(!0,"CREATE TABLE IF NOT EXISTS "+t+" (id BLOB PRIMARY KEY UNIQUE, data TEXT)",[],function(){e.K(!1,"SELECT id FROM "+t,[],function(n){for(var i=[],o=0;o<n.rows.length;o++)i.push(n.rows.item(o).id);e.L[t].sortIndex&&(i=i.sort(function(t,e){return t>e?1:-1})),e.L[t].set(i),r()})})}).then(t)},t.prototype.z=function(t){if(-1===Object.keys(this.L).indexOf(t))throw Error("No table "+t+" found!");return t},t.prototype.makeTable=function(t,e){var n=this;this.L[t]=new s.DatabaseIndex,e.forEach(function(e){e.props&&o.intersect(["pk","pk()"],e.props)&&(n.L[t].pkType=e.type,n.$[t]=e.key,e.props&&o.intersect(["ai","ai()"],e.props)&&("int"===e.type||"number"===e.type)&&(n.L[t].doAI=!0),(e.props&&o.intersect(["ns","ns()"],e.props)||-1!==["uuid","timeId","timeIdms"].indexOf(n.L[t].pkType))&&(n.L[t].sortIndex=!1))})},t.prototype.K=function(t,e,n,r){var i=function(t){t.executeSql(e,n,function(t,e){r(e)},function(t,r){return console.error(e,n,r),!1})};t?this.B.transaction(i):this.B.readTransaction(i)},t.prototype.write=function(t,e,n,i,s){if(e=e||o.generateID(this.L[t].pkType,this.L[t].ai)){var a,u,c=!1;if(this.L[t].exists(e)||(c=!0,this.L[t].add(e)),c){var f=r({},n,((a={})[this.$[t]]=e,a));this.K(!0,"INSERT into "+this.z(t)+" (id, data) VALUES (?, ?)",[e,JSON.stringify(f)],function(t){i(f)})}else{var h=r({},n,((u={})[this.$[t]]=e,u));this.K(!0,"UPDATE "+this.z(t)+" SET data = ? WHERE id = ?",[JSON.stringify(h),e],function(){i(h)})}}else s(new Error("nSQL: Can't add a row without a primary key!"))},t.prototype.delete=function(t,e,n){-1!==this.L[t].indexOf(e)&&this.L[t].remove(e),this.K(!0,"DELETE FROM "+this.z(t)+" WHERE id = ?",[e],function(){n()})},t.prototype.read=function(t,e,n){this.K(!1,"SELECT data FROM "+this.z(t)+" WHERE id = ?",[e],function(t){t.rows.length?n(JSON.parse(t.rows.item(0).data)):n(void 0)})},t.prototype.batchRead=function(t,e,n){this.K(!1,"SELECT data from "+this.z(t)+" WHERE id IN ("+e.map(function(t){return"?"}).join(", ")+") ORDER BY id",e,function(t){for(var e=t.rows.length,r=[];e--;)r.unshift(JSON.parse(t.rows.item(e).data));n(r)})},t.prototype.rangeRead=function(t,e,n,r,o,s){var a=this,u=this.L[t].keys(),c=-1===[typeof r,typeof o].indexOf("undefined"),f=c?[r,o]:[];if(u.length){s&&c&&(f=f.map(function(e){return a.L[t].getLocation(e)})),s&&c||!1!==this.L[t].sortIndex||(u=u.sort());var h=f[0]||0,l=[],d=f[0],p="SELECT data from "+this.z(t);if(f.length){for(u[d];d<=f[1];)l.push(u[d]),d++;p+=" WHERE id IN ("+l.map(function(t){return"?"}).join(", ")+")"}p+=" ORDER BY id",this.K(!1,p,l,function(t){var r=0,o=function(){t.rows.length>r?e(JSON.parse(t.rows.item(r).data),h,function(){h++,++r%500==0?i.setFast(o):o()}):n()};o()})}else n()},t.prototype.drop=function(t,e){this.L[t]=this.L[t].clone(),this.K(!0,"DELETE FROM "+this.z(t),[],function(t){e()})},t.prototype.getIndex=function(t,e,n){n(e?this.L[t].keys().length:this.L[t].keys())},t.prototype.destroy=function(t){var e=this;o.fastALL(Object.keys(this.L),function(t,n,r){e.drop(t,r)}).then(t)},t.prototype.setNSQL=function(t){s.syncPeerIndex(t,this.L)},t}();e.U=a},function(t,e,n){var r=this&&this.J||Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t};Object.defineProperty(e,"__esModule",{value:!0});var i=n(1),o=n(0),s=n(2),a=function(){function t(t){this.version=t,this.$={},this.L={},this.W={}}return t.prototype.onError=function(t){throw console.error(t),new Error("nSQL: IndexedDB Error!")},t.prototype.connect=function(t){var e=this;this.Y=o.hash(JSON.stringify(this.W));var n=1;this.version?n=this.version:(n=parseInt(localStorage.getItem(this.C+"-idb-version")||"")||1,(localStorage.getItem(this.C+"-idb-hash")||this.Y)!==this.Y&&n++,localStorage.setItem(this.C+"-idb-version",String(n)),localStorage.setItem(this.C+"-idb-hash",this.Y));var r=indexedDB.open(this.C,n),i={};r.onerror=this.onError,r.onupgradeneeded=function(t){e.B=t.target.result,Object.keys(e.L).forEach(function(t){e.B.objectStoreNames.contains(t)||e.B.createObjectStore(t,{keyPath:e.$[t]}),i[t]=[]})},r.onsuccess=function(n){e.B=n.target.result,o.fastALL(Object.keys(e.L),function(t,n,r){var i,o,s;i=t,o=function(n){e.L[t].set(n),r()},s=[],e.store(i,"readonly",function(t,n){var r=n.openCursor();r.onsuccess=function(t){var e=t.target.result;e&&(s.push(e.key),e.continue())},r.onerror=e.onError,t.oncomplete=function(){o(s)}})}).then(function(){t()})}},t.prototype.store=function(t,e,n){var r=this.B.transaction(t,e);r.onabort=this.onError,r.onerror=this.onError,n(r,r.objectStore(t))},t.prototype.setID=function(t){this.C=t},t.prototype.makeTable=function(t,e){var n=this;this.L[t]=new s.DatabaseIndex,this.W[t]=e,e.forEach(function(e){e.props&&o.intersect(["pk","pk()"],e.props)&&(n.L[t].pkType=e.type,n.$[t]=e.key,e.props&&o.intersect(["ai","ai()"],e.props)&&("int"===e.type||"number"===e.type)&&(n.L[t].doAI=!0),(e.props&&o.intersect(["ns","ns()"],e.props)||-1!==["uuid","timeId","timeIdms"].indexOf(n.L[t].pkType))&&(n.L[t].sortIndex=!1))})},t.prototype.write=function(t,e,n,i,s){if(e=e||o.generateID(this.L[t].pkType,this.L[t].ai)){-1===this.L[t].indexOf(e)&&this.L[t].add(e);var a,u=r({},n,((a={})[this.$[t]]=e,a));this.store(t,"readwrite",function(t,e){try{e.put(u).onsuccess=function(){i(u)}}catch(t){console.error(t),s(t)}})}else s(new Error("nSQL: Can't add a row without a primary key!"))},t.prototype.delete=function(t,e,n){var r=this;-1!==this.L[t].indexOf(e)&&this.L[t].remove(e),this.store(t,"readwrite",function(t,i){var o="_clear_"===e?i.clear():i.delete(e);o.onerror=r.onError,o.onsuccess=function(t){n()}})},t.prototype.read=function(t,e,n){var r=this;-1!==this.L[t].indexOf(e)?this.store(t,"readonly",function(t,i){var o=i.get(e);o.onerror=r.onError,o.onsuccess=function(){n(o.result)}}):n(null)},t.prototype.rangeRead=function(t,e,n,r,o,s){var a=this,u=this.L[t].keys(),c=-1===[typeof r,typeof o].indexOf("undefined"),f=c?[r,o]:[0,u.length-1];if(u.length){s&&c||!1!==this.L[t].sortIndex||(u=u.sort()),s&&c&&(f=f.map(function(e){var n=a.L[t].indexOf(e);return-1!==n?n:a.L[t].getLocation(e)}));var h=f[0],l=0,d=function(){h++,++l%500==0?i.setFast(p):p()},p=function(){h<=f[1]?a.read(t,u[h],function(t){e(t,h,d)}):n()};p()}else n()},t.prototype.drop=function(t,e){this.L[t]=this.L[t].clone(),this.delete(t,"_clear_",function(){e()})},t.prototype.getIndex=function(t,e,n){n(e?this.L[t].keys().length:this.L[t].keys())},t.prototype.destroy=function(t){var e=this;localStorage.removeItem(this.C+"-idb-version"),localStorage.removeItem(this.C+"-idb-hash"),o.fastALL(Object.keys(this.L),function(t,n,r){e.drop(t,r)}).then(t)},t.prototype.setNSQL=function(t){s.syncPeerIndex(t,this.L)},t}();e.Q=a},function(t,e,n){var r=this&&this.J||Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t};Object.defineProperty(e,"__esModule",{value:!0});var i=n(1),o=n(0),s=n(2),a=function(){function t(t){this.$={},this.G={},this.L={},this.X=t||!1}return t.prototype.connect=function(t){t()},t.prototype.setID=function(t){this.C=t},t.prototype.makeTable=function(t,e){var n=this;this.G[t]={},this.L[t]=new s.DatabaseIndex,e.forEach(function(e){if(e.props&&o.intersect(["pk","pk()"],e.props)&&(n.L[t].pkType=e.type,n.$[t]=e.key,e.props&&o.intersect(["ai","ai()"],e.props)&&("int"===e.type||"number"===e.type)&&(n.L[t].doAI=!0),(e.props&&o.intersect(["ns","ns()"],e.props)||-1!==["uuid","timeId","timeIdms"].indexOf(n.L[t].pkType))&&(n.L[t].sortIndex=!1),n.X)){var r=localStorage.getItem(n.C+"*"+t+"_idx");r&&n.L[t].set(JSON.parse(r))}})},t.prototype.write=function(t,e,n,i,s){var a,u;if(e=e||o.generateID(this.L[t].pkType,this.L[t].ai))if(-1===this.L[t].indexOf(e)&&(this.L[t].add(e),this.X&&localStorage.setItem(this.C+"*"+t+"_idx",JSON.stringify(this.L[t].keys()))),this.X){var c=r({},n,((a={})[this.$[t]]=e,a));localStorage.setItem(this.C+"*"+t+"__"+e,JSON.stringify(c)),i(c)}else c=r({},n,((u={})[this.$[t]]=e,u)),this.G[t][e]=o.deepFreeze(c),i(c);else s(new Error("nSQL: Can't add a row without a primary key!"))},t.prototype.delete=function(t,e,n){-1!==this.L[t].indexOf(e)&&(this.L[t].remove(e),this.X&&localStorage.setItem(this.C+"*"+t+"_idx",JSON.stringify(this.L[t].keys()))),this.X?localStorage.removeItem(this.C+"*"+t+"__"+e):delete this.G[t][e],n()},t.prototype.read=function(t,e,n){if(this.X){var r=localStorage.getItem(this.C+"*"+t+"__"+e);n(r?JSON.parse(r):void 0)}else n(this.G[t][e])},t.prototype.rangeRead=function(t,e,n,r,o,s){var a=this,u=this.L[t].keys(),c=-1===[typeof r,typeof o].indexOf("undefined"),f=c?[r,o]:[0,u.length-1];if(u.length){s&&c||!1!==this.L[t].sortIndex||(u=u.sort()),s&&c&&(f=f.map(function(e){var n=a.L[t].indexOf(e);return-1!==n?n:a.L[t].getLocation(e)}));var h=f[0],l=0,d=function(){h++,++l%500==0?i.setFast(p):p()},p=function(){if(h<=f[1])if(a.X){var r=localStorage.getItem(a.C+"*"+t+"__"+u[h]);e(r?JSON.parse(r):void 0,h,d)}else e(a.G[t][u[h]],h,d);else n()};p()}else n()},t.prototype.drop=function(t,e){var n=this;this.X?(localStorage.setItem(this.C+"*"+t+"_idx",JSON.stringify([])),this.L[t].keys().forEach(function(e){localStorage.removeItem(n.C+"*"+t+"__"+e)})):this.G[t]={},this.L[t]=this.L[t].clone(),e()},t.prototype.getIndex=function(t,e,n){n(e?this.L[t].keys().length:this.L[t].keys())},t.prototype.destroy=function(t){var e=this;o.fastALL(Object.keys(this.L),function(t,n,r){e.drop(t,r)}).then(t)},t.prototype.setNSQL=function(t){s.syncPeerIndex(t,this.L)},t}();e.q=a},function(t,e,n){"use strict";t.exports=function(t){var e,n;return(t=String(t).toLowerCase()).length<3?t:(t.charCodeAt(0)===r&&(e=!0,t="Y"+t.substr(1)),w.test(t)?t=t.substr(0,t.length-2):m.test(t)&&(t=t.substr(0,t.length-1)),(n=v.exec(t))?s.test(n[1])&&(t=t.substr(0,t.length-1)):(n=y.exec(t))&&c.test(n[1])&&(t=n[1],g.test(t)?t+="e":b.test(t)?t=t.substr(0,t.length-1):f.test(t)&&(t+="e")),(n=d.exec(t))&&c.test(n[1])&&(t=n[1]+"i"),(n=S.exec(t))&&s.test(n[1])&&(t=n[1]+i[n[2]]),(n=I.exec(t))&&s.test(n[1])&&(t=n[1]+o[n[2]]),(n=x.exec(t))?u.test(n[1])&&(t=n[1]):(n=p.exec(t))&&u.test(n[1])&&(t=n[1]),(n=l.exec(t))&&(u.test(n[1])||a.test(n[1])&&!f.test(n[1]))&&(t=n[1]),h.test(t)&&u.test(t)&&(t=t.substr(0,t.length-1)),e&&(t="y"+t.substr(1)),t)};var r="y".charCodeAt(0),i={ational:"ate",tional:"tion",enci:"ence",anci:"ance",izer:"ize",bli:"ble",alli:"al",entli:"ent",eli:"e",ousli:"ous",ization:"ize",ation:"ate",ator:"ate",alism:"al",iveness:"ive",fulness:"ful",ousness:"ous",aliti:"al",iviti:"ive",biliti:"ble",logi:"log"},o={icate:"ic",ative:"",alize:"al",iciti:"ic",ical:"ic",ful:"",ness:""},s=new RegExp("^([^aeiou][^aeiouy]*)?([aeiouy][aeiou]*)([^aeiou][^aeiouy]*)"),a=new RegExp("^([^aeiou][^aeiouy]*)?([aeiouy][aeiou]*)([^aeiou][^aeiouy]*)([aeiouy][aeiou]*)?$"),u=new RegExp("^([^aeiou][^aeiouy]*)?(([aeiouy][aeiou]*)([^aeiou][^aeiouy]*)){2,}"),c=new RegExp("^([^aeiou][^aeiouy]*)?[aeiouy]"),f=new RegExp("^([^aeiou][^aeiouy]*)[aeiouy][^aeiouwxy]$"),h=/ll$/,l=/^(.+?)e$/,d=/^(.+?)y$/,p=/^(.+?(s|t))(ion)$/,y=/^(.+?)(ed|ing)$/,g=/(at|bl|iz)$/,v=/^(.+?)eed$/,m=/^.+?[^s]s$/,w=/^.+?(ss|i)es$/,b=/([^aeiouylsz])\1$/,S=new RegExp("^(.+?)(ational|tional|enci|anci|izer|bli|alli|entli|eli|ousli|ization|ation|ator|alism|iveness|fulness|ousness|aliti|iviti|biliti|logi)$"),I=/^(.+?)(icate|ative|alize|iciti|ical|ful|ness)$/,x=new RegExp("^(.+?)(al|ance|ence|er|ic|able|ible|ant|ement|ment|ent|ou|ism|ate|iti|ous|ive|ize)$")},function(t,e,n){"use strict";t.exports=function(t){var e,n,f,h,l="",d=0;function p(t){l+=t}function y(e){return t.charAt(d+e).toUpperCase()}function g(t){return function(){return y(t)}}if(!(t=String(t||"")))return"";for(n=g(1),f=g(0),h=g(-1);!c(f());){if(!f())return"";d++}switch(f()){case"A":"E"===n()?(p("E"),d+=2):(p("A"),d++);break;case"G":case"K":case"P":"N"===n()&&(p("N"),d+=2);break;case"W":"R"===n()?(p(n()),d+=2):"H"===n()?(p(f()),d+=2):a(n())&&(p("W"),d+=2);break;case"X":p("S"),d++;break;case"E":case"I":case"O":case"U":p(f()),d++}for(;f();)if(e=1,!c(f())||f()===h()&&"C"!==f())d+=e;else{switch(f()){case"B":"M"!==h()&&p("B");break;case"C":s(n())?"I"===n()&&"A"===y(2)?p(r):"S"!==h()&&p("S"):"H"===n()?(p(r),e++):p("K");break;case"D":"G"===n()&&s(y(2))?(p("J"),e++):p("T");break;case"G":"H"===n()?o(y(-3))||"H"===y(-4)||(p("F"),e++):"N"===n()?!c(y(2))||"E"===y(2)&&"D"===y(3)||p("K"):s(n())&&"G"!==h()?p("J"):p("K");break;case"H":a(n())&&!u(h())&&p("H");break;case"K":"C"!==h()&&p("K");break;case"P":"H"===n()?p("F"):p("P");break;case"Q":p("K");break;case"S":"I"!==n()||"O"!==y(2)&&"A"!==y(2)?"H"===n()?(p(r),e++):p("S"):p(r);break;case"T":"I"!==n()||"O"!==y(2)&&"A"!==y(2)?"H"===n()?(p(i),e++):"C"===n()&&"H"===y(2)||p("T"):p(r);break;case"V":p("F");break;case"W":a(n())&&p("W");break;case"X":p("KS");break;case"Y":a(n())&&p("Y");break;case"Z":p("S");break;case"F":case"J":case"L":case"M":case"N":case"R":p(f())}d+=e}return l};var r="X",i="0";function o(t){return"B"===(t=f(t))||"D"===t||"H"===t}function s(t){return"E"===(t=f(t))||"I"===t||"Y"===t}function a(t){return"A"===(t=f(t))||"E"===t||"I"===t||"O"===t||"U"===t}function u(t){return"C"===(t=f(t))||"G"===t||"P"===t||"S"===t||"T"===t}function c(t){var e=function(t){return f(t).charCodeAt(0)}(t);return e>=65&&e<=90}function f(t){return String(t).charAt(0).toUpperCase()}},,,function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=0,i={},o=Array.prototype.slice,s="undefined"!=typeof window&&window.setImmediate?window.setImmediate:!("undefined"==typeof global||!global.setImmediate)&&global.setImmediate,a="undefined"!=typeof window&&window.postMessage&&window.addEventListener,u=function(t){return t[0].apply(null,o.call(t,1))};a&&window.addEventListener("message",function(t){var e,n=t.data;"string"==typeof n&&0===n.indexOf("setMsg")&&(e=i[n])&&(delete i[n],u(e))});e.setFast=s?function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];s(function(){u(t)})}:a?function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=r++,o="setMsg"+n;return i[o]=t,window.postMessage(o,"*"),n}:function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];setTimeout(function(){u(t)},0)};var c=function(){},f=["R"],h=["F"],l=["P"],d=function(){function t(t){this.h=l,this.v=[],this.y=void 0,t!==c&&m(this,t)}return t.doPolyFill=function(){"undefined"!=typeof global&&(global.u||(global.u=this)),"undefined"!=typeof window&&(window.u||(window.u=this))},t.prototype.catch=function(t){return this.then(function(){},t)},t.prototype.then=function(e,n){if("function"!=typeof e&&this.h===h||"function"!=typeof n&&this.h===f)return this;var r=new t(c);return this.h!==l?y(r,this.h===h?e:n,this.y):this.v.push(new p(r,e,n)),r},t.resolve=function(e){return e instanceof this?e:g.b(new t(c),e)},t.reject=function(e){return g.S(new t(c),e)},t.all=function(e){return new t(function(t,n){var r=[];if(e.length)for(var i=function(n,i,o){void 0!==o?r.push(o):r.push(i),r.length==e.length&&t(r)},o=function(t){e[t].then(function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];i(0,t,void 0)}).catch(function(t){i(0,void 0,t)})},s=0;s<e.length;s++)o(s);else t([])})},t.race=function(e){var n,r=e.length,i=!1,o=-1,s=new t(c);if(!1!==Array.isArray(e))return this.reject(new TypeError);if(!r)return this.resolve([]);for(;++o<r;)n=e[o],this.resolve(n).then(function(t){i||(i=!0,g.b(s,t))},function(t){i||(i=!0,g.S(s,t))});return s},t}();e.u=d;var p=function(){function t(t,e,n){this.T=t,"function"==typeof e&&(this.O=e,this.k=this.M),"function"==typeof n&&(this.j=n,this._=this.I)}return t.prototype.k=function(t){g.b(this.T,t)},t.prototype.M=function(t){y(this.T,this.O,t)},t.prototype._=function(t){g.S(this.T,t)},t.prototype.I=function(t){y(this.T,this.j,t)},t}();function y(t,n,r){e.setFast(function(){var e;try{e=n.apply(null,r)}catch(e){return g.S(t,e)}return e===t?g.S(t,new TypeError):g.b(t,e),null})}e.R=p;var g=function(){function t(){}return t.b=function(e,n){var r=w(v,n),i=r.N,o=-1,s=e.v.length;if("error"===r.A)return t.S(e,r.N);if(i)m(e,i);else for(e.h=h,e.y=n;++o<s;)e.v[o].k(n);return e},t.S=function(t,e){t.h=f,t.y=e;for(var n=-1,r=t.v.length;++n<r;)t.v[n]._(e);return t},t}();function v(t){var e=t&&t.then;return!t||"object"!=typeof t&&"function"!=typeof t||"function"!=typeof e?null:function(){e.apply(t,arguments)}}function m(t,e){var n=!1;function r(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];n||(n=!0,g.S(t,e))}function i(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];n||(n=!0,g.b(t,e))}var o=w(function(){e(i,r)});"error"===o.A&&r(o.N)}function w(t,e){var n={A:null,N:null};try{n.N=t(e),n.A="success"}catch(t){n.A="error",n.N=t}return n}},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0});var r=n(10);e.u="undefined"!=typeof window&&window.u?window.u:"undefined"!=typeof global&&global.u?global.u:r.u,e.f=function(t){return t?JSON.parse(JSON.stringify(t)):null},e.fastCHAIN=function(t,n){return new e.u(function(e,i){if(t&&t.length){var o=[],s=function(){o.length<t.length?n(t[o.length],o.length,function(t){o.push(t),r.setFast(s)}):e(o)};s()}else e([])})},e.fastRACE=function(t,n){return new e.u(function(e,r){if(t&&t.length){var i=!1,o=0,s=function(){o<t.length&&(n(t[o],o,function(t){i||(i=!0,e([t]))}),o++,s())};s()}else e([])})},e.fastALL=function(t,n){return e.u.all((t||[]).map(function(t,r){return new e.u(function(e,i){n(t,r,function(t){e(t)})})}))};var i="undefined"==typeof window?"":navigator.userAgent||"";e.isSafari=0!==i.length&&(/^((?!chrome|android).)*safari/i.test(i)||/iPad|iPhone|iPod/.test(i)&&!window.MSStream),e.isMSBrowser=0!==i.length&&(i.indexOf("MSIE ")>0||i.indexOf("Trident/")>0||i.indexOf("Edge/")>0),e.isAndroid=/Android/.test(i),e.random16Bits=function(){if("undefined"==typeof crypto)return Math.round(Math.random()*Math.pow(2,16));if(crypto.getRandomValues){var t=new Uint16Array(1);return crypto.getRandomValues(t),t[0]}return"undefined"!=typeof global&&global.a.randomBytes?global.a.randomBytes(2).reduce(function(t,e){return e*t}):Math.round(Math.random()*Math.pow(2,16))},e.timeid=function(t){for(var n=Math.round((new Date).getTime()/(t?1:1e3)).toString();n.length<(t?13:10);)n="0"+n;return n+"-"+(e.random16Bits()+e.random16Bits()).toString(16)},e.intersect=function(t,e){return!(!t||!e)&&!(!t.length||!e.length)&&(t||[]).filter(function(t){return-1!==(e||[]).indexOf(t)}).length>0},e.uuid=function(){var t,n,r="";return[r,r,r,r,r,r,r,r].reduce(function(i,o,s){for(t=e.random16Bits(),n=3===s?4:4===s?(t%16&3|8).toString(16):r,t=t.toString(16);t.length<4;)t="0"+t;return i+([2,3,4,5].indexOf(s)>-1?"-":r)+(n+t).slice(0,4)},r)};var o={int:function(t){return t},uuid:e.uuid,timeId:function(){return e.timeid()},timeIdms:function(){return e.timeid(!0)}};e.hash=function(t){for(var e=5381,n=t.length;n;)e=33*e^t.charCodeAt(--n);return(e>>>0).toString(16)},e.generateID=function(t,e){return o[t]?o[t](e||1):""},e.cleanArgs=function(t,n){for(var r={},i=t.length;i--;){var o=t[i].split(":");o.length>1?r[o[0]]=e.cast(o[1],n[o[0]]||void 0):r[o[0]]=n[o[0]]||void 0}return r},e.isObject=function(t){return"[object Object]"===Object.prototype.toString.call(t)},e.levenshtein=function(t,e){if(0===t.length)return e.length;if(0===e.length)return t.length;var n,r,i,o,s,a;for(t.length>e.length&&(n=t,t=e,e=n),a=Array(t.length+1),r=0;r<=t.length;r++)a[r]=r;for(r=1;r<=e.length;r++){for(o=r,i=1;i<=t.length;i++)s=e[r-1]===t[i-1]?a[i-1]:Math.min(a[i-1]+1,Math.min(o+1,a[i]+1)),a[i-1]=o,o=s;a[t.length]=o}return a[t.length]},e.cast=function(t,n){if("any"===t||"blob"===t)return n;var r=typeof n;if("undefined"===r||null===n)return n;var i={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;","`":"&#x60;","=":"&#x3D;"},o=function(t,n){switch(t){case"safestr":return o("string",n).replace(/[&<>"'`=\/]/gim,function(t){return i[t]});case"int":return"number"!==r||n%1!=0?parseInt(n||0):n;case"number":case"float":return"number"!==r?parseFloat(n||0):n;case"any[]":case"array":return Array.isArray(n)?n:[];case"uuid":case"timeId":case"timeIdms":case"string":return"string"!==r?String(n):n;case"object":case"obj":case"map":return e.isObject(n)?n:{};case"boolean":case"bool":return!0===n}return n},s=o(String(t||"").toLowerCase(),n);if(-1!==t.indexOf("[]")){var a=t.slice(0,t.lastIndexOf("[]"));return(n||[]).map(function(t){return e.cast(a,t)})}return void 0!==s?["int","float","number"].indexOf(t)>-1&&isNaN(s)?0:s:void 0},e.sortedInsert=function(t,n,r,i){return t.length?(t.splice(e.binarySearch(t,n),0,n),t):(t.push(n),t)},e.binarySearch=function(t,e,n,r){var i,o=0,s=t.length-1;if(e<t[o])return 0;if(e>t[s])return s+1;if(s<=2147483647)for(;o<=s;){if(t[i=o+s>>1]===e)return i;t[i]<e?o=i+1:s=i-1}else for(;o<=s;){if(t[i=Math.floor((o+s)/2)]===e)return i;t[i]<e?o=i+1:s=i-1}return i},e.removeDuplicates=function(t){if(!t.length)return[];for(var e=[t[0]],n=1;n<t.length;n++)t[n]!==t[n-1]&&e.push(t[n]);return e},e.deepFreeze=function(t){return Object.getOwnPropertyNames(t||{}).forEach(function(n){var r=t[n];"object"==typeof r&&null!==r&&(t[n]=e.deepFreeze(r))}),Object.freeze(t)};var s={};e.objQuery=function(t,e,n){var r=function(t,e,n){return t[e]&&n?r(t,e+1,n[t[e]]):n},i=t+(n?"1":"0");if(s[i])return r(s[i],0,e);var o=[];if(o=t.indexOf("[")>-1?[].concat.apply([],t.split(".").map(function(t){return t.match(/([^\[]+)|\[([^\]]+)\]\[/gim)||t})).map(function(t){return t.replace(/\[|\]/gim,"")}):t.split("."),n){var a=o.shift()+"."+o.shift();o.unshift(a)}return s[i]=o,r(s[i],0,e)}},function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.myConsole=Object.create(console,{assert:{value:function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if("undefined"==typeof window)try{console.assert.apply(console,[t,e].concat(n))}catch(t){console.error(t.stack)}else console.assert.apply(console,[t,e].concat(n))},configurable:!0,enumerable:!0,writable:!0}}),e.equals=function(t,e){var n=function(t,e){var r,i,o,s,a;if((r=toString.call(t))!==toString.call(e))return!1;switch(r){default:return t.valueOf()===e.valueOf();case"[object Number]":return e=+e,(t=+t)?t===e:t==t?1/t==1/e:e!=e;case"[object RegExp]":return t.source===e.source&&t.global===e.global&&t.ignoreCase===e.ignoreCase&&t.multiline===e.multiline&&t.lastIndex===e.lastIndex;case"[object Function]":return!1;case"[object Array]":if((i=t.length)!==e.length)return!1;for(;i--;)if(!((s=t[i])===(a=e[i])&&0!==s||n(s,a)))return!1;return!0;case"[object Object]":for(o in i=0,t)if(t.hasOwnProperty(o)){if(++i,(s=t[o])===(a=e[o])&&0!==s||n(s,a))continue;return!1}for(o in e)if(e.hasOwnProperty(o)&&--i<0)return!1;return!0}};return t===e&&0!==t||n(t,e)}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=0,i={},o=Array.prototype.slice,s="undefined"!=typeof window&&window.setImmediate?window.setImmediate:!("undefined"==typeof global||!global.setImmediate)&&global.setImmediate,a="undefined"!=typeof window&&window.postMessage&&window.addEventListener,u=function(t){return t[0].apply(null,o.call(t,1))};a&&window.addEventListener("message",function(t){var e,n=t.data;"string"==typeof n&&0===n.indexOf("setMsg")&&(e=i[n])&&(delete i[n],u(e))});e.setFast=s?function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];s(function(){u(t)})}:a?function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=r++,o="setMsg"+n;return i[o]=t,window.postMessage(o,"*"),n}:function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];setTimeout(function(){u(t)},0)};var c=function(){},f=["R"],h=["F"],l=["P"],d=function(){function t(t){this.h=l,this.v=[],this.y=void 0,t!==c&&m(this,t)}return t.doPolyFill=function(){"undefined"!=typeof global&&(global.u||(global.u=this)),"undefined"!=typeof window&&(window.u||(window.u=this))},t.prototype.catch=function(t){return this.then(function(){},t)},t.prototype.then=function(e,n){if("function"!=typeof e&&this.h===h||"function"!=typeof n&&this.h===f)return this;var r=new t(c);return this.h!==l?y(r,this.h===h?e:n,this.y):this.v.push(new p(r,e,n)),r},t.resolve=function(e){return e instanceof this?e:g.b(new t(c),e)},t.reject=function(e){return g.S(new t(c),e)},t.all=function(e){return new t(function(t,n){var r=[];if(e.length)for(var i=function(n,i,o){void 0!==o?r.push(o):r.push(i),r.length==e.length&&t(r)},o=function(t){e[t].then(function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];i(0,t,void 0)}).catch(function(t){i(0,void 0,t)})},s=0;s<e.length;s++)o(s);else t([])})},t.race=function(e){var n,r=e.length,i=!1,o=-1,s=new t(c);if(!1!==Array.isArray(e))return this.reject(new TypeError);if(!r)return this.resolve([]);for(;++o<r;)n=e[o],this.resolve(n).then(function(t){i||(i=!0,g.b(s,t))},function(t){i||(i=!0,g.S(s,t))});return s},t}();e.u=d;var p=function(){function t(t,e,n){this.T=t,"function"==typeof e&&(this.O=e,this.k=this.M),"function"==typeof n&&(this.j=n,this._=this.I)}return t.prototype.k=function(t){g.b(this.T,t)},t.prototype.M=function(t){y(this.T,this.O,t)},t.prototype._=function(t){g.S(this.T,t)},t.prototype.I=function(t){y(this.T,this.j,t)},t}();function y(t,n,r){e.setFast(function(){var e;try{e=n.apply(null,r)}catch(e){return g.S(t,e)}return e===t?g.S(t,new TypeError):g.b(t,e),null})}e.R=p;var g=function(){function t(){}return t.b=function(e,n){var r=w(v,n),i=r.N,o=-1,s=e.v.length;if("error"===r.A)return t.S(e,r.N);if(i)m(e,i);else for(e.h=h,e.y=n;++o<s;)e.v[o].k(n);return e},t.S=function(t,e){t.h=f,t.y=e;for(var n=-1,r=t.v.length;++n<r;)t.v[n]._(e);return t},t}();function v(t){var e=t&&t.then;return!t||"object"!=typeof t&&"function"!=typeof t||"function"!=typeof e?null:function(){e.apply(t,arguments)}}function m(t,e){var n=!1;function r(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];n||(n=!0,g.S(t,e))}function i(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];n||(n=!0,g.b(t,e))}var o=w(function(){e(i,r)});"error"===o.A&&r(o.N)}function w(t,e){var n={A:null,N:null};try{n.N=t(e),n.A="success"}catch(t){n.A="error",n.N=t}return n}},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0});var r=n(13),i=n(12),o=n(11),s=function(){function t(t,e){var n=this;this.adapter=t,this.args=e,new r.u(function(t,e){var r=new((i=n.adapter).bind.apply(i,[void 0].concat(n.args)));r.setID("123");var i,o=[{key:"id",type:"int",props:["pk","ai"]}];r.makeTable("test",o),r.makeTable("test2",o),r.makeTable("test3",o),r.makeTable("test4",o),r.makeTable("test5",o),r.connect(function(){r.destroy(t)})}).then(function(){return n.PrimaryKeys()}).then(function(){return console.log("✓ Primary Key Tests Passed"),n.Writes()}).then(function(){return console.log("✓ Write Tests Passed"),n.RangeReads()}).then(function(){return console.log("✓ Range Read Tests Passed (number)"),n.RangeReadsUUID()}).then(function(){return console.log("✓ Range Read Tests Passed (uuid)"),n.Deletes()}).then(function(){console.log("✓ Delete Tests Passed"),console.log("✓ All Tests Passed!******"),process.exit()}).catch(function(t){process.exit(),console.error("Test Failed",t)})}return t.prototype.Deletes=function(){var t,e=new((t=this.adapter).bind.apply(t,[void 0].concat(this.args))),n=[];return new r.u(function(t,n){e.setID("123"),e.makeTable("test",[{key:"id",type:"int",props:["ai","pk"]},{key:"name",type:"string"}]),e.connect(t)}).then(function(){return new r.u(function(t,r){for(var i=[],s=0;s<100;s++)n.push({id:s+1,name:"Title "+(s+1)}),i.push("Title "+(s+1));o.fastCHAIN(i,function(t,n,r){e.write("test",null,{name:t},r)}).then(t)})}).then(function(){return new r.u(function(t,r){e.delete("test",3,function(){var o=[];e.rangeRead("test",function(t,e,n){o.push(t),n()},function(){var e=i.equals(o,n.filter(function(t){return 3!==t.id}));i.myConsole.assert(e,"Delete Test"),e?t():r(o)},void 0,void 0)})})}).then(function(){return new r.u(function(t,n){e.destroy(t)})})},t.prototype.RangeReads=function(){var t,e=new((t=this.adapter).bind.apply(t,[void 0].concat(this.args))),n=[],s=[];return new r.u(function(t,n){e.setID("123"),e.makeTable("test",[{key:"id",type:"int",props:["ai","pk"]},{key:"name",type:"string"}]),e.connect(t)}).then(function(){return new r.u(function(t,r){for(var i=[],a=0;a<100;a++)n.push({id:a+1,name:"Title "+(a+1)}),i.push("Title "+(a+1)),s.push(a+1);o.fastCHAIN(i,function(t,n,r){e.write("test",null,{name:t},r)}).then(t)})}).then(function(){return new r.u(function(t,r){if(e.batchRead){var o=[10,11,12,20];e.batchRead("test",o,function(e){var s=i.equals(e.sort(function(t,e){return t.id>e.id?1:-1}),n.filter(function(t){return-1!==o.indexOf(t.id)}));i.myConsole.assert(s,"Select Batch Rows"),s?t():r(e)})}else t()})}).then(function(){return new r.u(function(t,r){var o=[];e.rangeRead("test",function(t,e,n){o.push(t),n()},function(){var e=i.equals(o,n.filter(function(t){return t.id>10&&t.id<22}));i.myConsole.assert(e,"Select Range Test"),e?t():r(o)},10,20)})}).then(function(){return new r.u(function(t,r){var o=[];e.rangeRead("test",function(t,e,n){o.push(t),n()},function(){var e=i.equals(o,n.filter(function(t){return t.id>9&&t.id<21}));i.myConsole.assert(e,"Select Range Test (Primary Key)"),e?t():r({g:o,e:n.filter(function(t){return t.id>9&&t.id<21})})},10,20,!0)})}).then(function(){return new r.u(function(t,r){var o=[];console.time("READ"),e.rangeRead("test",function(t,e,n){o.push(t),n()},function(){console.timeEnd("READ");var e=i.equals(o,n);i.myConsole.assert(e,"Select Entire Table Test"),e?t():r({e:n,g:o})},void 0,void 0)})}).then(function(){return new r.u(function(t,n){e.getIndex("test",!1,function(e){var r=i.equals(e,s);i.myConsole.assert(r,"Select Index Test"),r?t():n({e:s,g:e})})})}).then(function(){return new r.u(function(t,n){e.getIndex("test",!0,function(e){var r=100===e;i.myConsole.assert(r,"Select Index Length Test"),r?t():n(e)})})}).then(function(){return new r.u(function(t,n){e.destroy(t)})})},t.prototype.RangeReadsUUID=function(){var t,e=new((t=this.adapter).bind.apply(t,[void 0].concat(this.args))),n=[],s=[];return new r.u(function(t,n){e.setID("123"),e.makeTable("test",[{key:"id",type:"uuid",props:["ai","pk"]},{key:"name",type:"string"}]),e.connect(t)}).then(function(){return new r.u(function(t,r){for(var i=[],a=0;a<100;a++){var u=o.uuid();n.push({id:u,name:"Title "+u}),i.push("Title "+u),s.push(u)}s.sort(function(t,e){return t>e?1:-1}),n.sort(function(t,e){return t.id>e.id?1:-1}),o.fastCHAIN(n,function(t,n,r){e.write("test",t.id,t,r)}).then(t)})}).then(function(){return new r.u(function(t,r){if(e.batchRead){for(var o=[],s=0;s<5;s++)o.push(n[Math.floor(Math.random()*n.length)].id);o=o.filter(function(t,e,n){return n.indexOf(t)===e}),e.batchRead("test",o,function(e){var s=i.equals(e,n.filter(function(t){return-1!==o.indexOf(t.id)}));i.myConsole.assert(s,"Select Batch Rows"),s?t():r({e:n.filter(function(t){return-1!==o.indexOf(t.id)}),g:e})})}else t()})}).then(function(){return new r.u(function(t,r){var o=[];e.rangeRead("test",function(t,e,n){o.push(t),n()},function(){var e=i.equals(o,n.filter(function(t,e){return e>9&&e<21}));i.myConsole.assert(e,"Select Range Test"),e?t():r({g:o,e:n.filter(function(t,e){return e>9&&e<21})})},10,20)})}).then(function(){return new r.u(function(t,r){var o=[];e.rangeRead("test",function(t,e,n){o.push(t),n()},function(){var e=i.equals(o,n.filter(function(t){return t.id>=n[10].id&&t.id<=n[20].id}));i.myConsole.assert(e,"Select Range Test (Primary Key)"),e?t():r({g:o,e:n.filter(function(t){return t.id>=n[10].id&&t.id<=n[20].id})})},n[10].id,n[20].id,!0)})}).then(function(){return new r.u(function(t,r){var o=[];console.time("READ"),e.rangeRead("test",function(t,e,n){o.push(t),n()},function(){console.timeEnd("READ");var e=i.equals(o,n);i.myConsole.assert(e,"Select Entire Table Test"),e?t():r(o)},void 0,void 0)})}).then(function(){return new r.u(function(t,n){e.getIndex("test",!1,function(e){var r=i.equals(e,s);i.myConsole.assert(r,"Select Index Test"),r?t():n({e:s,g:e})})})}).then(function(){return new r.u(function(t,n){e.getIndex("test",!0,function(e){var r=100===e;i.myConsole.assert(r,"Select Index Length Test"),r?t():n(e)})})}).then(function(){return new r.u(function(t,n){e.destroy(t)})})},t.prototype.Writes=function(){var t,e=new((t=this.adapter).bind.apply(t,[void 0].concat(this.args)));return new r.u(function(t,n){e.setID("123"),e.makeTable("test",[{key:"id",type:"int",props:["ai","pk"]},{key:"name",type:"string"},{key:"posts",type:"string[]"}]),e.connect(t)}).then(function(){return new r.u(function(t,n){e.write("test",null,{name:"Test",posts:[1,2]},function(r){e.read("test",r.id,function(e){var r=i.equals(e,{name:"Test",id:1,posts:[1,2]});i.myConsole.assert(r,"Insert Test"),r?t():n(e)})})})}).then(function(){return new r.u(function(t,n){e.write("test",1,{name:"Testing",posts:[1,2]},function(r){e.read("test",r.id,function(e){var r=i.equals(e,{name:"Testing",id:1,posts:[1,2]});i.myConsole.assert(r,"Update Test"),r?t():n(e)})})})}).then(function(){return new r.u(function(t,n){e.write("test",1,{name:"Testing"},function(r){e.read("test",r.id,function(e){var r=i.equals(e,{name:"Testing",id:1});i.myConsole.assert(r,"Replace Test"),r?t():n(e)})})})}).then(function(){return new r.u(function(t,n){e.destroy(t)})})},t.prototype.PrimaryKeys=function(){var t,e=new((t=this.adapter).bind.apply(t,[void 0].concat(this.args)));return new r.u(function(t,n){e.setID("123"),e.makeTable("test",[{key:"id",type:"int",props:["ai","pk"]},{key:"name",type:"string"}]),e.makeTable("test2",[{key:"id",type:"uuid",props:["pk"]},{key:"name",type:"string"}]),e.makeTable("test3",[{key:"id",type:"timeId",props:["pk"]},{key:"name",type:"string"}]),e.makeTable("test4",[{key:"id",type:"timeIdms",props:["pk"]},{key:"name",type:"string"}]),e.makeTable("test5",[{key:"id",type:"uuid",props:["pk"]},{key:"name",type:"string"}]),e.connect(t)}).then(function(){return new r.u(function(t,n){e.write("test",null,{name:"Test"},function(e){var r=i.equals(e,{name:"Test",id:1});i.myConsole.assert(r,"Test Auto Incriment Integer."),r?t():n(e)})})}).then(function(){return new r.u(function(t,n){e.write("test2",null,{name:"Test"},function(e){var r=e.id.match(/^\w{8}-\w{4}-\w{4}-\w{4}-\w{12}$/);i.myConsole.assert(r,"Test UUID."),r?t():n(e.id)})})}).then(function(){return new r.u(function(t,n){e.write("test3",null,{name:"Test"},function(e){var r=e.id.match(/^\w{10}-\w{1,5}$/);i.myConsole.assert(r,"Test timeId."),r?t():n(e.id)})})}).then(function(){return new r.u(function(t,n){e.write("test4",null,{name:"Test"},function(e){var r=e.id.match(/^\w{13}-\w{1,5}$/);i.myConsole.assert(r,"Test timeIdms."),r?t():n(e.id)})})}).then(function(){return new r.u(function(t,n){for(var r=[],s=0;s<20;s++)r.push(o.uuid());o.fastCHAIN(r,function(t,n,r){e.write("test5",t,{name:"Test"},r)}).then(function(){r.sort();var o=[];e.rangeRead("test5",function(t,e,n){o.push(t.id),n()},function(){var e=i.equals(o,r);i.myConsole.assert(e,"Test Sorted Primary Keys."),e?t():n({e:r,g:o})},void 0,void 0)})})}).then(function(){return new r.u(function(t,n){e.destroy(t)})})},t}();e.TestAdapter=s},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0});var r=n(14),i=n(4),o=n(5),s=n(3);n(0).fastCHAIN([i.Q,o.q,s.U],function(t,e,n){switch(e){case 0:console.log("Testing IndexedDB...");break;case 1:console.log(""),console.log("Testing Sync Store...");break;case 2:console.log(""),console.log("Testing WebSQL...")}new r.TestAdapter(t,[]),setTimeout(n,3e3)}).then(function(){console.log("TESTS COMPLETE")})},function(t,e,n){t.exports=n(15)}])});