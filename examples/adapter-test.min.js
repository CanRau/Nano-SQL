!function(t,e){if("object"==typeof exports&&"object"==typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var n=e();for(var r in n)("object"==typeof exports?exports:t)[r]=n[r]}}(window,function(){return function(t){var e={};function n(r){if(e[r])return e[r].exports;var i=e[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.u)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)n.d(r,i,function(e){return t[e]}.bind(null,i));return r},n.n=function(t){var e=t&&t.u?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=25)}([function(t,e,n){(function(t){Object.defineProperty(e,"__esModule",{value:!0});var r=n(4),i=n(5);n(1).Promise.doPolyFill(),e.stopWords=["a","about","after","all","also","am","an","and","andor","another","any","are","as","at","be","because","been","before","being","between","both","but","by","came","can","come","could","did","do","each","for","from","get","got","had","has","have","he","her","here","him","himself","his","how","i","if","in","into","is","it","like","make","many","me","might","more","most","much","must","my","never","now","of","on","only","or","other","our","out","over","said","same","see","should","since","some","still","such","take","than","that","the","their","them","then","there","these","they","this","those","through","to","too","under","up","very","was","way","we","well","were","what","where","which","while","who","with","would","you","your"],e.a=function(t){return t?JSON.parse(JSON.stringify(t)):null},e.fastCHAIN=function(t,n){return new Promise(function(r,i){if(t&&t.length){var o=[],s=!1,a=function(){if(o.length<t.length)n(t[o.length],o.length,function(t){o.push(t),o.length%100==0?e.setFast(a):a()},function(t){s=!0,i(t)});else{if(s)return;r(o)}};a()}else r([])})},e.fastRACE=function(t,e){return new Promise(function(n,r){if(t&&t.length){var i=!1,o=0,s=function(){o<t.length&&(e(t[o],o,function(t){i||(i=!0,n([t]))},function(t){i||(i=!0,r(t))}),o++,s())};s()}else n([])})},e.fastALL=function(t,e){return Promise.all((t||[]).map(function(t,n){return new Promise(function(r,i){e(t,n,r,i)})}))};var o="undefined"==typeof window?"":navigator.userAgent||"";e.isSafari=0!==o.length&&(/^((?!chrome|android).)*safari/i.test(o)||/iPad|iPhone|iPod/.test(o)&&!window.MSStream),e.isMSBrowser=0!==o.length&&(o.indexOf("MSIE ")>0||o.indexOf("Trident/")>0||o.indexOf("Edge/")>0),e.isAndroid=/Android/.test(o),e.random16Bits=function(){if("undefined"==typeof crypto)return Math.round(Math.random()*Math.pow(2,16));if(crypto.getRandomValues){var e=new Uint16Array(1);return crypto.getRandomValues(e),e[0]}return void 0!==t&&t.f.randomBytes?t.f.randomBytes(2).reduce(function(t,e){return e*t}):Math.round(Math.random()*Math.pow(2,16))},e.tokenizer=function(t,n,o,s,a){var u=function(t){return!t||1===String(t).length||-1!==e.stopWords.indexOf(t)},c=(s||"").toLowerCase().replace(/(\d+)\/(\d+)|(?:\d+(?:,\d+)*|\d+)(?:\.\d+)?/gim,function(t,e,n){return e||n?(parseInt(e)/parseInt(n)).toFixed(a||4):parseFloat(t.replace(/\,/gim,"")).toFixed(a||4)}).replace(/\-|\_|\[|\]|\(|\)|\{|\}|\r?\n|\r|\t/gim," ").replace(/[^\w\s]|(\d\.)/gim,"$1").replace(/\s+/g," ").split(" ");switch(o[1]){case"english":return c.map(function(t,e){return{i:e,o:t,w:isNaN(t)?u(t)?"":r(i(t)):t}});case"english-stem":return c.map(function(t,e){return{i:e,o:t,w:isNaN(t)?u(t)?"":i(t):t}});case"english-meta":return c.map(function(t,e){return{i:e,o:t,w:isNaN(t)?u(t)?"":r(t):t}})}return c.map(function(t,e){return{o:t,w:t,i:e}})},e.timeid=function(t){for(var n=Math.round((new Date).getTime()/(t?1:1e3)).toString();n.length<(t?13:10);)n="0"+n;return n+"-"+(e.random16Bits()+e.random16Bits()).toString(16)},e.intersect=function(t,e){return!(!t||!e)&&!(!t.length||!e.length)&&(t||[]).filter(function(t){return-1!==(e||[]).indexOf(t)}).length>0},e.uuid=function(){var t,n,r="";return[r,r,r,r,r,r,r,r].reduce(function(i,o,s){for(t=e.random16Bits(),n=3===s?4:4===s?(t%16&3|8).toString(16):r,t=t.toString(16);t.length<4;)t="0"+t;return i+([2,3,4,5].indexOf(s)>-1?"-":r)+(n+t).slice(0,4)},r)},e.hash=function(t){for(var e=5381,n=t.length;n;)e=33*e^t.charCodeAt(--n);return(e>>>0).toString(16)};var s={int:function(t){return t},uuid:e.uuid,timeId:function(){return e.timeid()},timeIdms:function(){return e.timeid(!0)}};e.generateID=function(t,e){return s[t]?s[t](e||1):""},e.cleanArgs=function(t,n){for(var r={},i=t.length;i--;){var o=t[i].split(":");o.length>1?r[o[0]]=e.cast(o[1],n[o[0]]||void 0):r[o[0]]=n[o[0]]||void 0}return r},e.isObject=function(t){return"[object Object]"===Object.prototype.toString.call(t)},e.cast=function(t,n){if("any"===t||"blob"===t)return n;var r=typeof n;if("undefined"===r||null===n)return n;var i={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;","`":"&#x60;","=":"&#x3D;"},o=function(t,n){switch(t){case"safestr":return o("string",n).replace(/[&<>"'`=\/]/gim,function(t){return i[t]});case"int":return"number"!==r||n%1!=0?parseInt(n||0):n;case"number":case"float":return"number"!==r?parseFloat(n||0):n;case"any[]":case"array":return Array.isArray(n)?n:[];case"uuid":case"timeId":case"timeIdms":case"string":return"string"!==r?String(n):n;case"object":case"obj":case"map":return e.isObject(n)?n:{};case"boolean":case"bool":return!0===n}return n},s=o(String(t||"").toLowerCase(),n);if(-1!==t.indexOf("[]")){var a=t.slice(0,t.lastIndexOf("[]"));return(n||[]).map(function(t){return e.cast(a,t)})}return void 0!==s?["int","float","number"].indexOf(t)>-1&&isNaN(s)?0:s:void 0},e.binarySearch=function(t,n,r,i){var o=r||0,s=i||t.length;if(t[o]>n)return o;if(t[s]<n)return s+1;var a=Math.floor((o+s)/2);return n===t[a]?a:s-1===o?s:n>t[a]?e.binarySearch(t,n,a,s):n<t[a]?e.binarySearch(t,n,o,a):s},e.removeDuplicates=function(t){if(!t.length)return[];for(var e=[t[0]],n=1;n<t.length;n++)t[n]!==t[n-1]&&e.push(t[n]);return e},e.deepFreeze=function(t){return Object.getOwnPropertyNames(t||{}).forEach(function(n){var r=t[n];"object"==typeof r&&null!==r&&(t[n]=e.deepFreeze(r))}),Object.freeze(t)},e.crowDistance=function(t,e,n,r,i){void 0===i&&(i=6371);var o=function(t){return t*(Math.PI/180)},s=o(n-t),a=o(r-e),u=Math.sin(s/2)*Math.sin(s/2)+Math.cos(o(t))*Math.cos(o(n))*Math.sin(a/2)*Math.sin(a/2);return i*(2*Math.atan2(Math.sqrt(u),Math.sqrt(1-u)))};var a={};e.objQuery=function(t,e,n){var r=function(t,e,n){return t[e]&&n?r(t,e+1,n[t[e]]):n},i=t+(n?"1":"0");if(a[i])return r(a[i],0,e);var o=[];if(o=t.indexOf("[")>-1?[].concat.apply([],t.split(".").map(function(t){return t.match(/([^\[]+)|\[([^\]]+)\]\[/gim)||t})).map(function(t){return t.replace(/\[|\]/gim,"")}):t.split("."),n){var s=o.shift()+"."+o.shift();o.unshift(s)}return a[i]=o,r(a[i],0,e)};var u=0,c={},f=Array.prototype.slice,h="undefined"!=typeof window&&window.postMessage&&window.addEventListener,l=function(t){return t[0].apply(null,f.call(t,1))};h&&window.addEventListener("message",function(t){var e,n=t.data;"string"==typeof n&&0===n.indexOf("setMsg")&&(e=c[n])&&(delete c[n],l(e))});e.setFast=h?function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=u++,r="setMsg"+n;return c[r]=t,window.postMessage(r,"*"),n}:function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];setTimeout(function(){l(t)},0)}}).call(this,n(2))},function(t,e,n){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0});var n=0,r={},i=Array.prototype.slice,o="undefined"!=typeof window&&window.postMessage&&window.addEventListener,s=function(t){return t[0].apply(null,i.call(t,1))};o&&window.addEventListener("message",function(t){var e,n=t.data;"string"==typeof n&&0===n.indexOf("setMsg")&&(e=r[n])&&(delete r[n],s(e))});e.setFast=o?function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i=n++,o="setMsg"+i;return r[o]=t,window.postMessage(o,"*"),i}:function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];setTimeout(function(){s(t)},0)};var a=function(){},u=["R"],c=["F"],f=["P"],h=function(){function e(t){this.h=f,this.v=[],this.y=void 0,t!==a&&m(this,t)}return e.doPolyFill=function(){void 0!==t&&(t.Promise||(t.Promise=this)),"undefined"!=typeof window&&(window.Promise||(window.Promise=this))},e.prototype.catch=function(t){return this.then(function(){},t)},e.prototype.then=function(t,n){if("function"!=typeof t&&this.h===c||"function"!=typeof n&&this.h===u)return this;var r=new e(a);return this.h!==f?d(r,this.h===c?t:n,this.y):this.v.push(new l(r,t,n)),r},e.resolve=function(t){return t instanceof this?t:p.b(new e(a),t)},e.reject=function(t){return p.S(new e(a),t)},e.all=function(t){return new e(function(e,n){var r=[];if(t.length)for(var i=function(n,i,o){void 0!==o?r.push(o):r.push(i),r.length==t.length&&e(r)},o=function(e){t[e].then(function(t){i(0,t,void 0)}).catch(function(t){i(0,void 0,t)})},s=0;s<t.length;s++)o(s);else e([])})},e.race=function(t){var n=this,r=t.length,i=!1,o=-1,s=new e(a);if(!1!==Array.isArray(t))return this.reject(new TypeError);function u(t){n.resolve(t).then(function(t){i||(i=!0,p.b(s,t))},function(t){i||(i=!0,p.S(s,t))})}if(!r)return this.resolve([]);for(;++o<r;)u(t[o]);return s},e}();e.Promise=h;var l=function(){function t(t,e,n){this.T=t,"function"==typeof e&&(this.O=e,this.k=this.M),"function"==typeof n&&(this.j=n,this.I=this._)}return t.prototype.k=function(t){p.b(this.T,t)},t.prototype.M=function(t){d(this.T,this.O,t)},t.prototype.I=function(t){p.S(this.T,t)},t.prototype._=function(t){d(this.T,this.j,t)},t}();function d(t,n,r){e.setFast(function(){var e;try{e=n.apply(null,r)}catch(e){return p.S(t,e)}return e===t?p.S(t,new TypeError):p.b(t,e),null})}e.N=l;var p=function(){function t(){}return t.b=function(e,n){var r=g(y,n),i=r.R,o=-1,s=e.v.length;if("error"===r.x)return t.S(e,r.R);if(i)m(e,i);else for(e.h=c,e.y=n;++o<s;)e.v[o].k(n);return e},t.S=function(t,e){t.h=u,t.y=e;for(var n=-1,r=t.v.length;++n<r;)t.v[n].I(e);return t},t}();function y(t){var e=t&&t.then;return!t||"object"!=typeof t&&"function"!=typeof t||"function"!=typeof e?null:function(){e.apply(t,arguments)}}function m(t,e){var n=!1;function r(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];n||(n=!0,p.S(t,e))}function i(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];n||(n=!0,p.b(t,e))}var o=g(function(){e(i,r)});"error"===o.x&&r(o.R)}function g(t,e){var n={x:null,R:null};try{n.R=t(e),n.x="success"}catch(t){n.x="error",n.R=t}return n}}).call(this,n(2))},function(t,e){var n;n=function(){return this}();try{n=n||Function("return this")()||(0,eval)("this")}catch(t){"object"==typeof window&&(n=window)}t.exports=n},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0});var r=n(0),i=function(){function t(){this.A=[],this.P={},this.ai=1,this.sortIndex=!0,this.doAI=!1}return t.prototype.clone=function(e){this.D&&!e&&this.D(this.F,"drop",null);var n=new t;return n.doAI=this.doAI,n.ai=this.ai,n.sortIndex=this.sortIndex,n.D=this.D,n.F=this.F,n.pkType=this.pkType,e&&this.set([]),n},t.prototype.onChange=function(t,e){this.F=t,this.D=e},t.prototype.set=function(t){var e=this;this.A=t||[],this.P={},this.A.forEach(function(t,n){e.P[String(t)]=!0}),this.doAI&&this.A.length&&(this.ai=this.A[this.A.length-1]+1)},t.prototype.getLocation=function(t,e){var n=this.indexOf(t);return-1!==n?n:this.sortIndex?r.binarySearch(this.A,t,e):r.binarySearch(this.A.sort(function(t,e){return t>e?1:-1}),t,e)},t.prototype.add=function(t,e){if(!this.P[String(t)])if(this.D&&!e&&this.D(this.F,"add",t),this.P[String(t)]=!0,e&&-1!==["number","int","float"].indexOf(this.pkType)&&(t=parseFloat(t)),this.doAI)this.ai++,this.A.push(t);else if(this.sortIndex){var n=r.binarySearch(this.A,t);this.A.splice(n,0,t)}else this.A.push(t)},t.prototype.keys=function(){return this.A},t.prototype.exists=function(t){return!!this.P[String(t)]},t.prototype.indexOf=function(t){return this.P[String(t)]?this.sortIndex?r.binarySearch(this.A,t):this.A.indexOf(t):-1},t.prototype.remove=function(t,e){if(this.D&&!e&&this.D(this.F,"rm",t),e&&-1!==["number","int","float"].indexOf(this.pkType)&&(t=parseFloat(t)),this.P[String(t)]){var n=this.indexOf(t);this.P[String(t)]=!1,this.A.splice(n,1)}},t}();e.DatabaseIndex=i,e.syncPeerIndex=function(t,e){t.peerMode&&(Object.keys(e).forEach(function(n){e[n].onChange(n,function(e,n,i){t.peers.filter(function(e){return e!==t.pid}).forEach(function(t){localStorage.setItem(t+"::"+r.random16Bits().toString(16),n+","+e+","+(i||""))})})}),window.addEventListener("storage",function(n){if(n.key&&-1!==n.key.indexOf(t.pid+"::")){var r=(n.newValue||"").split(",");switch(localStorage.removeItem(n.key),r[0]){case"rm":e[r[1]].remove(r[2],!0);break;case"add":e[r[1]].add(r[2],!0);break;case"drop":e[r[1]].clone(!0)}}}))}},function(t,e,n){"use strict";t.exports=function(t){var e,n,f,h,l="",d=0;function p(t){l+=t}function y(e){return t.charAt(d+e).toUpperCase()}function m(t){return function(){return y(t)}}if(!(t=String(t||"")))return"";for(n=m(1),f=m(0),h=m(-1);!c(f());){if(!f())return"";d++}switch(f()){case"A":"E"===n()?(p("E"),d+=2):(p("A"),d++);break;case"G":case"K":case"P":"N"===n()&&(p("N"),d+=2);break;case"W":"R"===n()?(p(n()),d+=2):"H"===n()?(p(f()),d+=2):a(n())&&(p("W"),d+=2);break;case"X":p("S"),d++;break;case"E":case"I":case"O":case"U":p(f()),d++}for(;f();)if(e=1,!c(f())||f()===h()&&"C"!==f())d+=e;else{switch(f()){case"B":"M"!==h()&&p("B");break;case"C":s(n())?"I"===n()&&"A"===y(2)?p(r):"S"!==h()&&p("S"):"H"===n()?(p(r),e++):p("K");break;case"D":"G"===n()&&s(y(2))?(p("J"),e++):p("T");break;case"G":"H"===n()?o(y(-3))||"H"===y(-4)||(p("F"),e++):"N"===n()?!c(y(2))||"E"===y(2)&&"D"===y(3)||p("K"):s(n())&&"G"!==h()?p("J"):p("K");break;case"H":a(n())&&!u(h())&&p("H");break;case"K":"C"!==h()&&p("K");break;case"P":"H"===n()?p("F"):p("P");break;case"Q":p("K");break;case"S":"I"!==n()||"O"!==y(2)&&"A"!==y(2)?"H"===n()?(p(r),e++):p("S"):p(r);break;case"T":"I"!==n()||"O"!==y(2)&&"A"!==y(2)?"H"===n()?(p(i),e++):"C"===n()&&"H"===y(2)||p("T"):p(r);break;case"V":p("F");break;case"W":a(n())&&p("W");break;case"X":p("KS");break;case"Y":a(n())&&p("Y");break;case"Z":p("S");break;case"F":case"J":case"L":case"M":case"N":case"R":p(f())}d+=e}return l};var r="X",i="0";function o(t){return"B"===(t=f(t))||"D"===t||"H"===t}function s(t){return"E"===(t=f(t))||"I"===t||"Y"===t}function a(t){return"A"===(t=f(t))||"E"===t||"I"===t||"O"===t||"U"===t}function u(t){return"C"===(t=f(t))||"G"===t||"P"===t||"S"===t||"T"===t}function c(t){var e=function(t){return f(t).charCodeAt(0)}(t);return e>=65&&e<=90}function f(t){return String(t).charAt(0).toUpperCase()}},function(t,e,n){"use strict";t.exports=function(t){var e,n;return(t=String(t).toLowerCase()).length<3?t:(t.charCodeAt(0)===r&&(e=!0,t="Y"+t.substr(1)),w.test(t)?t=t.substr(0,t.length-2):v.test(t)&&(t=t.substr(0,t.length-1)),(n=g.exec(t))?s.test(n[1])&&(t=t.substr(0,t.length-1)):(n=y.exec(t))&&c.test(n[1])&&(t=n[1],m.test(t)?t+="e":b.test(t)?t=t.substr(0,t.length-1):f.test(t)&&(t+="e")),(n=d.exec(t))&&c.test(n[1])&&(t=n[1]+"i"),(n=S.exec(t))&&s.test(n[1])&&(t=n[1]+i[n[2]]),(n=x.exec(t))&&s.test(n[1])&&(t=n[1]+o[n[2]]),(n=T.exec(t))?u.test(n[1])&&(t=n[1]):(n=p.exec(t))&&u.test(n[1])&&(t=n[1]),(n=l.exec(t))&&(u.test(n[1])||a.test(n[1])&&!f.test(n[1]))&&(t=n[1]),h.test(t)&&u.test(t)&&(t=t.substr(0,t.length-1)),e&&(t="y"+t.substr(1)),t)};var r="y".charCodeAt(0),i={ational:"ate",tional:"tion",enci:"ence",anci:"ance",izer:"ize",bli:"ble",alli:"al",entli:"ent",eli:"e",ousli:"ous",ization:"ize",ation:"ate",ator:"ate",alism:"al",iveness:"ive",fulness:"ful",ousness:"ous",aliti:"al",iviti:"ive",biliti:"ble",logi:"log"},o={icate:"ic",ative:"",alize:"al",iciti:"ic",ical:"ic",ful:"",ness:""},s=new RegExp("^([^aeiou][^aeiouy]*)?([aeiouy][aeiou]*)([^aeiou][^aeiouy]*)"),a=new RegExp("^([^aeiou][^aeiouy]*)?([aeiouy][aeiou]*)([^aeiou][^aeiouy]*)([aeiouy][aeiou]*)?$"),u=new RegExp("^([^aeiou][^aeiouy]*)?(([aeiouy][aeiou]*)([^aeiou][^aeiouy]*)){2,}"),c=new RegExp("^([^aeiou][^aeiouy]*)?[aeiouy]"),f=new RegExp("^([^aeiou][^aeiouy]*)[aeiouy][^aeiouwxy]$"),h=/ll$/,l=/^(.+?)e$/,d=/^(.+?)y$/,p=/^(.+?(s|t))(ion)$/,y=/^(.+?)(ed|ing)$/,m=/(at|bl|iz)$/,g=/^(.+?)eed$/,v=/^.+?[^s]s$/,w=/^.+?(ss|i)es$/,b=/([^aeiouylsz])\1$/,S=new RegExp("^(.+?)(ational|tional|enci|anci|izer|bli|alli|entli|eli|ousli|ization|ation|ator|alism|iveness|fulness|ousness|aliti|iviti|biliti|logi)$"),x=/^(.+?)(icate|ative|alize|iciti|ical|ful|ness)$/,T=new RegExp("^(.+?)(al|ance|ence|er|ic|able|ible|ant|ement|ment|ent|ou|ism|ate|iti|ous|ive|ize)$")},,function(t,e,n){var r=this&&this.J||Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t};Object.defineProperty(e,"__esModule",{value:!0});var i=n(1),o=n(0),s=n(3),a=function(){function t(t){this.$={},this.L={},this.H={},this.C=t||!1}return t.prototype.connect=function(t){t()},t.prototype.setID=function(t){this.B=t},t.prototype.makeTable=function(t,e){var n=this;this.L[t]={},this.H[t]=new s.DatabaseIndex,e.forEach(function(e){if(e.props&&o.intersect(["pk","pk()"],e.props)&&(n.H[t].pkType=e.type,n.$[t]=e.key,e.props&&o.intersect(["ai","ai()"],e.props)&&("int"===e.type||"number"===e.type)&&(n.H[t].doAI=!0),(e.props&&o.intersect(["ns","ns()"],e.props)||-1!==["uuid","timeId","timeIdms"].indexOf(n.H[t].pkType))&&(n.H[t].sortIndex=!1),n.C)){var r=localStorage.getItem(n.B+"*"+t+"_idx");r&&n.H[t].set(JSON.parse(r))}})},t.prototype.write=function(t,e,n,i,s){var a,u;if(e=e||o.generateID(this.H[t].pkType,this.H[t].ai))if(-1===this.H[t].indexOf(e)&&(this.H[t].add(e),this.C&&localStorage.setItem(this.B+"*"+t+"_idx",JSON.stringify(this.H[t].keys()))),this.C){var c=r({},n,((a={})[this.$[t]]=e,a));localStorage.setItem(this.B+"*"+t+"__"+e,JSON.stringify(c)),i(c)}else c=r({},n,((u={})[this.$[t]]=e,u)),this.L[t][e]=o.deepFreeze(c),i(c);else s(new Error("nSQL: Can't add a row without a primary key!"))},t.prototype.delete=function(t,e,n){-1!==this.H[t].indexOf(e)&&(this.H[t].remove(e),this.C&&localStorage.setItem(this.B+"*"+t+"_idx",JSON.stringify(this.H[t].keys()))),this.C?localStorage.removeItem(this.B+"*"+t+"__"+e):delete this.L[t][e],n()},t.prototype.read=function(t,e,n){if(this.C){var r=localStorage.getItem(this.B+"*"+t+"__"+e);n(r?JSON.parse(r):void 0)}else n(this.L[t][e])},t.prototype.rangeRead=function(t,e,n,r,o,s){var a=this,u=this.H[t].keys(),c=-1===[typeof r,typeof o].indexOf("undefined"),f=c?[r,o]:[0,u.length-1];if(u.length){s&&c||!1!==this.H[t].sortIndex||(u=u.sort()),s&&c&&(f=f.map(function(e){var n=a.H[t].indexOf(e);return-1!==n?n:a.H[t].getLocation(e)}));var h=f[0],l=0,d=function(){h++,++l%500==0?i.setFast(p):p()},p=function(){if(h<=f[1])if(a.C){var r=localStorage.getItem(a.B+"*"+t+"__"+u[h]);e(r?JSON.parse(r):void 0,h,d)}else e(a.L[t][u[h]],h,d);else n()};p()}else n()},t.prototype.drop=function(t,e){var n=this;this.C?(localStorage.setItem(this.B+"*"+t+"_idx",JSON.stringify([])),this.H[t].keys().forEach(function(e){localStorage.removeItem(n.B+"*"+t+"__"+e)})):this.L[t]={},this.H[t]=this.H[t].clone(),e()},t.prototype.getIndex=function(t,e,n){n(e?this.H[t].keys().length:this.H[t].keys())},t.prototype.destroy=function(t){var e=this;o.fastALL(Object.keys(this.H),function(t,n,r){e.drop(t,r)}).then(t)},t.prototype.setNSQL=function(t){s.syncPeerIndex(t,this.H)},t}();e.K=a},function(t,e,n){var r=this&&this.J||Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t};Object.defineProperty(e,"__esModule",{value:!0});var i=n(1),o=n(0),s=n(3),a=function(){function t(t){this.version=t,this.$={},this.H={},this.z={}}return t.prototype.onError=function(t){throw console.error(t),new Error("nSQL: IndexedDB Error!")},t.prototype.connect=function(t){var e=this;this.U=o.hash(JSON.stringify(this.z));var n=1;this.version?n=this.version:(n=parseInt(localStorage.getItem(this.B+"-idb-version")||"")||1,(localStorage.getItem(this.B+"-idb-hash")||this.U)!==this.U&&n++,localStorage.setItem(this.B+"-idb-version",String(n)),localStorage.setItem(this.B+"-idb-hash",this.U));var r=indexedDB.open(this.B,n),i={};r.onerror=this.onError,r.onupgradeneeded=function(t){e.W=t.target.result,Object.keys(e.H).forEach(function(t){e.W.objectStoreNames.contains(t)||e.W.createObjectStore(t,{keyPath:e.$[t]}),i[t]=[]})},r.onsuccess=function(n){e.W=n.target.result,o.fastALL(Object.keys(e.H),function(t,n,r){!function(t,n){var r=[];e.store(t,"readonly",function(t,i){var o=i.openCursor();o.onsuccess=function(t){var e=t.target.result;e&&(r.push(e.key),e.continue())},o.onerror=e.onError,t.oncomplete=function(){n(r)}})}(t,function(n){e.H[t].set(n),r()})}).then(function(){t()})}},t.prototype.store=function(t,e,n){var r=this.W.transaction(t,e);r.onabort=this.onError,r.onerror=this.onError,n(r,r.objectStore(t))},t.prototype.setID=function(t){this.B=t},t.prototype.makeTable=function(t,e){var n=this;this.H[t]=new s.DatabaseIndex,this.z[t]=e,e.forEach(function(e){e.props&&o.intersect(["pk","pk()"],e.props)&&(n.H[t].pkType=e.type,n.$[t]=e.key,e.props&&o.intersect(["ai","ai()"],e.props)&&("int"===e.type||"number"===e.type)&&(n.H[t].doAI=!0),(e.props&&o.intersect(["ns","ns()"],e.props)||-1!==["uuid","timeId","timeIdms"].indexOf(n.H[t].pkType))&&(n.H[t].sortIndex=!1))})},t.prototype.write=function(t,e,n,i,s){var a;if(e=e||o.generateID(this.H[t].pkType,this.H[t].ai)){-1===this.H[t].indexOf(e)&&this.H[t].add(e);var u=r({},n,((a={})[this.$[t]]=e,a));this.store(t,"readwrite",function(t,e){try{e.put(u).onsuccess=function(){i(u)}}catch(t){console.error(t),s(t)}})}else s(new Error("nSQL: Can't add a row without a primary key!"))},t.prototype.delete=function(t,e,n){var r=this;-1!==this.H[t].indexOf(e)&&this.H[t].remove(e),this.store(t,"readwrite",function(t,i){var o="_clear_"===e?i.clear():i.delete(e);o.onerror=r.onError,o.onsuccess=function(t){n()}})},t.prototype.read=function(t,e,n){var r=this;-1!==this.H[t].indexOf(e)?this.store(t,"readonly",function(t,i){var o=i.get(e);o.onerror=r.onError,o.onsuccess=function(){n(o.result)}}):n(null)},t.prototype.rangeRead=function(t,e,n,r,o,s){var a=this,u=this.H[t].keys(),c=-1===[typeof r,typeof o].indexOf("undefined"),f=c?[r,o]:[0,u.length-1];if(u.length){s&&c||!1!==this.H[t].sortIndex||(u=u.sort()),s&&c&&(f=f.map(function(e){var n=a.H[t].indexOf(e);return-1!==n?n:a.H[t].getLocation(e)}));var h=f[0],l=0,d=function(){h++,++l%500==0?i.setFast(p):p()},p=function(){h<=f[1]?a.read(t,u[h],function(t){e(t,h,d)}):n()};p()}else n()},t.prototype.drop=function(t,e){this.H[t]=this.H[t].clone(),this.delete(t,"_clear_",function(){e()})},t.prototype.getIndex=function(t,e,n){n(e?this.H[t].keys().length:this.H[t].keys())},t.prototype.destroy=function(t){var e=this;localStorage.removeItem(this.B+"-idb-version"),localStorage.removeItem(this.B+"-idb-hash"),o.fastALL(Object.keys(this.H),function(t,n,r){e.drop(t,r)}).then(t)},t.prototype.setNSQL=function(t){s.syncPeerIndex(t,this.H)},t}();e.Y=a},function(t,e,n){var r=this&&this.J||Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t};Object.defineProperty(e,"__esModule",{value:!0});var i=n(1),o=n(0),s=n(3),a=function(){function t(t){this.$={},this.H={},this.Q=1e3*(t||0)*1e3}return t.prototype.setID=function(t){this.B=t},t.prototype.connect=function(t){var e=this;this.W=window.openDatabase(this.B,"1.0",this.B,this.Q||o.isAndroid?5e6:1),o.fastALL(Object.keys(this.$),function(t,n,r){e.G(!0,"CREATE TABLE IF NOT EXISTS "+t+" (id BLOB PRIMARY KEY UNIQUE, data TEXT)",[],function(){e.G(!1,"SELECT id FROM "+t,[],function(n){for(var i=[],o=0;o<n.rows.length;o++)i.push(n.rows.item(o).id);e.H[t].sortIndex&&(i=i.sort(function(t,e){return t>e?1:-1})),e.H[t].set(i),r()})})}).then(t)},t.prototype.X=function(t){if(-1===Object.keys(this.H).indexOf(t))throw Error("No table "+t+" found!");return t},t.prototype.makeTable=function(t,e){var n=this;this.H[t]=new s.DatabaseIndex,e.forEach(function(e){e.props&&o.intersect(["pk","pk()"],e.props)&&(n.H[t].pkType=e.type,n.$[t]=e.key,e.props&&o.intersect(["ai","ai()"],e.props)&&("int"===e.type||"number"===e.type)&&(n.H[t].doAI=!0),(e.props&&o.intersect(["ns","ns()"],e.props)||-1!==["uuid","timeId","timeIdms"].indexOf(n.H[t].pkType))&&(n.H[t].sortIndex=!1))})},t.prototype.G=function(t,e,n,r){var i=function(t){t.executeSql(e,n,function(t,e){r(e)},function(t,r){return console.error(e,n,r),!1})};t?this.W.transaction(i):this.W.readTransaction(i)},t.prototype.write=function(t,e,n,i,s){var a,u;if(e=e||o.generateID(this.H[t].pkType,this.H[t].ai)){var c=!1;if(this.H[t].exists(e)||(c=!0,this.H[t].add(e)),c){var f=r({},n,((a={})[this.$[t]]=e,a));this.G(!0,"INSERT into "+this.X(t)+" (id, data) VALUES (?, ?)",[e,JSON.stringify(f)],function(t){i(f)})}else{var h=r({},n,((u={})[this.$[t]]=e,u));this.G(!0,"UPDATE "+this.X(t)+" SET data = ? WHERE id = ?",[JSON.stringify(h),e],function(){i(h)})}}else s(new Error("nSQL: Can't add a row without a primary key!"))},t.prototype.delete=function(t,e,n){-1!==this.H[t].indexOf(e)&&this.H[t].remove(e),this.G(!0,"DELETE FROM "+this.X(t)+" WHERE id = ?",[e],function(){n()})},t.prototype.read=function(t,e,n){this.G(!1,"SELECT data FROM "+this.X(t)+" WHERE id = ?",[e],function(t){t.rows.length?n(JSON.parse(t.rows.item(0).data)):n(void 0)})},t.prototype.batchRead=function(t,e,n){this.G(!1,"SELECT data from "+this.X(t)+" WHERE id IN ("+e.map(function(t){return"?"}).join(", ")+") ORDER BY id",e,function(t){for(var e=t.rows.length,r=[];e--;)r.unshift(JSON.parse(t.rows.item(e).data));n(r)})},t.prototype.rangeRead=function(t,e,n,r,o,s){var a=this,u=this.H[t].keys(),c=-1===[typeof r,typeof o].indexOf("undefined"),f=c?[r,o]:[];if(u.length){s&&c&&(f=f.map(function(e){return a.H[t].getLocation(e)})),s&&c||!1!==this.H[t].sortIndex||(u=u.sort());var h=f[0]||0,l=[],d=f[0],p="SELECT data from "+this.X(t);if(f.length){for(u[d];d<=f[1];)l.push(u[d]),d++;p+=" WHERE id IN ("+l.map(function(t){return"?"}).join(", ")+")"}p+=" ORDER BY id",this.G(!1,p,l,function(t){var r=0,o=function(){t.rows.length>r?e(JSON.parse(t.rows.item(r).data),h,function(){h++,++r%500==0?i.setFast(o):o()}):n()};o()})}else n()},t.prototype.drop=function(t,e){this.H[t]=this.H[t].clone(),this.G(!0,"DELETE FROM "+this.X(t),[],function(t){e()})},t.prototype.getIndex=function(t,e,n){n(e?this.H[t].keys().length:this.H[t].keys())},t.prototype.destroy=function(t){var e=this;o.fastALL(Object.keys(this.H),function(t,n,r){e.drop(t,r)}).then(t)},t.prototype.setNSQL=function(t){s.syncPeerIndex(t,this.H)},t}();e.q=a},,,,,,,,,,,,,,,,function(t,e,n){t.exports=n(26)},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0});var r=n(27),i=n(8),o=n(7),s=n(9);n(0).fastCHAIN([i.Y,o.K,s.q],function(t,e,n){switch(e){case 0:console.log("Testing IndexedDB...");break;case 1:console.log(""),console.log("Testing Sync Store...");break;case 2:console.log(""),console.log("Testing WebSQL...")}new r.TestAdapter(t,[]),setTimeout(n,3e3)}).then(function(){console.log("TESTS COMPLETE")})},function(t,e,n){(function(t){Object.defineProperty(e,"__esModule",{value:!0});var r=n(29),i=n(30),o=n(31),s=function(){function e(e,n){var i=this;this.adapter=e,this.args=n,new r.Promise(function(t,e){var n=new((r=i.adapter).bind.apply(r,[void 0].concat(i.args)));n.setID("123");var r,o=[{key:"id",type:"int",props:["pk","ai"]}];n.makeTable("test",o),n.makeTable("test2",o),n.makeTable("test3",o),n.makeTable("test4",o),n.makeTable("test5",o),n.connect(function(){n.destroy(t)})}).then(function(){return i.PrimaryKeys()}).then(function(){return console.log("✓ Primary Key Tests Passed"),i.Writes()}).then(function(){return console.log("✓ Write Tests Passed"),i.RangeReads()}).then(function(){return console.log("✓ Range Read Tests Passed (number)"),i.RangeReadsUUID()}).then(function(){return console.log("✓ Range Read Tests Passed (uuid)"),i.Deletes()}).then(function(){console.log("✓ Delete Tests Passed"),console.log("✓ All Tests Passed!******"),t.exit()}).catch(function(e){t.exit(),console.error("Test Failed",e)})}return e.prototype.Deletes=function(){var t,e=new((t=this.adapter).bind.apply(t,[void 0].concat(this.args))),n=[];return new r.Promise(function(t,n){e.setID("123"),e.makeTable("test",[{key:"id",type:"int",props:["ai","pk"]},{key:"name",type:"string"}]),e.connect(t)}).then(function(){return new r.Promise(function(t,r){for(var i=[],s=0;s<100;s++)n.push({id:s+1,name:"Title "+(s+1)}),i.push("Title "+(s+1));o.fastCHAIN(i,function(t,n,r){e.write("test",null,{name:t},r)}).then(t)})}).then(function(){return new r.Promise(function(t,r){e.delete("test",3,function(){var o=[];e.rangeRead("test",function(t,e,n){o.push(t),n()},function(){var e=i.equals(o,n.filter(function(t){return 3!==t.id}));i.myConsole.assert(e,"Delete Test"),e?t():r(o)},void 0,void 0)})})}).then(function(){return new r.Promise(function(t,n){e.destroy(t)})})},e.prototype.RangeReads=function(){var t,e=new((t=this.adapter).bind.apply(t,[void 0].concat(this.args))),n=[],s=[];return new r.Promise(function(t,n){e.setID("123"),e.makeTable("test",[{key:"id",type:"int",props:["ai","pk"]},{key:"name",type:"string"}]),e.connect(t)}).then(function(){return new r.Promise(function(t,r){for(var i=[],a=0;a<100;a++)n.push({id:a+1,name:"Title "+(a+1)}),i.push("Title "+(a+1)),s.push(a+1);o.fastCHAIN(i,function(t,n,r){e.write("test",null,{name:t},r)}).then(t)})}).then(function(){return new r.Promise(function(t,r){if(e.batchRead){var o=[10,11,12,20];e.batchRead("test",o,function(e){var s=i.equals(e.sort(function(t,e){return t.id>e.id?1:-1}),n.filter(function(t){return-1!==o.indexOf(t.id)}));i.myConsole.assert(s,"Select Batch Rows"),s?t():r(e)})}else t()})}).then(function(){return new r.Promise(function(t,r){var o=[];e.rangeRead("test",function(t,e,n){o.push(t),n()},function(){var e=i.equals(o,n.filter(function(t){return t.id>10&&t.id<22}));i.myConsole.assert(e,"Select Range Test"),e?t():r(o)},10,20)})}).then(function(){return new r.Promise(function(t,r){var o=[];e.rangeRead("test",function(t,e,n){o.push(t),n()},function(){var e=i.equals(o,n.filter(function(t){return t.id>9&&t.id<21}));i.myConsole.assert(e,"Select Range Test (Primary Key)"),e?t():r({g:o,e:n.filter(function(t){return t.id>9&&t.id<21})})},10,20,!0)})}).then(function(){return new r.Promise(function(t,r){var o=[];console.time("READ"),e.rangeRead("test",function(t,e,n){o.push(t),n()},function(){console.timeEnd("READ");var e=i.equals(o,n);i.myConsole.assert(e,"Select Entire Table Test"),e?t():r({e:n,g:o})},void 0,void 0)})}).then(function(){return new r.Promise(function(t,n){e.getIndex("test",!1,function(e){var r=i.equals(e,s);i.myConsole.assert(r,"Select Index Test"),r?t():n({e:s,g:e})})})}).then(function(){return new r.Promise(function(t,n){e.getIndex("test",!0,function(e){var r=100===e;i.myConsole.assert(r,"Select Index Length Test"),r?t():n(e)})})}).then(function(){return new r.Promise(function(t,n){e.destroy(t)})})},e.prototype.RangeReadsUUID=function(){var t,e=new((t=this.adapter).bind.apply(t,[void 0].concat(this.args))),n=[],s=[];return new r.Promise(function(t,n){e.setID("123"),e.makeTable("test",[{key:"id",type:"uuid",props:["ai","pk"]},{key:"name",type:"string"}]),e.connect(t)}).then(function(){return new r.Promise(function(t,r){for(var i=[],a=0;a<100;a++){var u=o.uuid();n.push({id:u,name:"Title "+u}),i.push("Title "+u),s.push(u)}s.sort(function(t,e){return t>e?1:-1}),n.sort(function(t,e){return t.id>e.id?1:-1}),o.fastCHAIN(n,function(t,n,r){e.write("test",t.id,t,r)}).then(t)})}).then(function(){return new r.Promise(function(t,r){if(e.batchRead){for(var o=[],s=0;s<5;s++)o.push(n[Math.floor(Math.random()*n.length)].id);o=o.filter(function(t,e,n){return n.indexOf(t)===e}),e.batchRead("test",o,function(e){var s=i.equals(e,n.filter(function(t){return-1!==o.indexOf(t.id)}));i.myConsole.assert(s,"Select Batch Rows"),s?t():r({e:n.filter(function(t){return-1!==o.indexOf(t.id)}),g:e})})}else t()})}).then(function(){return new r.Promise(function(t,r){var o=[];e.rangeRead("test",function(t,e,n){o.push(t),n()},function(){var e=i.equals(o,n.filter(function(t,e){return e>9&&e<21}));i.myConsole.assert(e,"Select Range Test"),e?t():r({g:o,e:n.filter(function(t,e){return e>9&&e<21})})},10,20)})}).then(function(){return new r.Promise(function(t,r){var o=[];e.rangeRead("test",function(t,e,n){o.push(t),n()},function(){var e=i.equals(o,n.filter(function(t){return t.id>=n[10].id&&t.id<=n[20].id}));i.myConsole.assert(e,"Select Range Test (Primary Key)"),e?t():r({g:o,e:n.filter(function(t){return t.id>=n[10].id&&t.id<=n[20].id})})},n[10].id,n[20].id,!0)})}).then(function(){return new r.Promise(function(t,r){var o=[];console.time("READ"),e.rangeRead("test",function(t,e,n){o.push(t),n()},function(){console.timeEnd("READ");var e=i.equals(o,n);i.myConsole.assert(e,"Select Entire Table Test"),e?t():r(o)},void 0,void 0)})}).then(function(){return new r.Promise(function(t,n){e.getIndex("test",!1,function(e){var r=i.equals(e,s);i.myConsole.assert(r,"Select Index Test"),r?t():n({e:s,g:e})})})}).then(function(){return new r.Promise(function(t,n){e.getIndex("test",!0,function(e){var r=100===e;i.myConsole.assert(r,"Select Index Length Test"),r?t():n(e)})})}).then(function(){return new r.Promise(function(t,n){e.destroy(t)})})},e.prototype.Writes=function(){var t,e=new((t=this.adapter).bind.apply(t,[void 0].concat(this.args)));return new r.Promise(function(t,n){e.setID("123"),e.makeTable("test",[{key:"id",type:"int",props:["ai","pk"]},{key:"name",type:"string"},{key:"posts",type:"string[]"}]),e.connect(t)}).then(function(){return new r.Promise(function(t,n){e.write("test",null,{name:"Test",posts:[1,2]},function(r){e.read("test",r.id,function(e){var r=i.equals(e,{name:"Test",id:1,posts:[1,2]});i.myConsole.assert(r,"Insert Test"),r?t():n(e)})})})}).then(function(){return new r.Promise(function(t,n){e.write("test",1,{name:"Testing",posts:[1,2]},function(r){e.read("test",r.id,function(e){var r=i.equals(e,{name:"Testing",id:1,posts:[1,2]});i.myConsole.assert(r,"Update Test"),r?t():n(e)})})})}).then(function(){return new r.Promise(function(t,n){e.write("test",1,{name:"Testing"},function(r){e.read("test",r.id,function(e){var r=i.equals(e,{name:"Testing",id:1});i.myConsole.assert(r,"Replace Test"),r?t():n(e)})})})}).then(function(){return new r.Promise(function(t,n){e.destroy(t)})})},e.prototype.PrimaryKeys=function(){var t,e=new((t=this.adapter).bind.apply(t,[void 0].concat(this.args)));return new r.Promise(function(t,n){e.setID("123"),e.makeTable("test",[{key:"id",type:"int",props:["ai","pk"]},{key:"name",type:"string"}]),e.makeTable("test2",[{key:"id",type:"uuid",props:["pk"]},{key:"name",type:"string"}]),e.makeTable("test3",[{key:"id",type:"timeId",props:["pk"]},{key:"name",type:"string"}]),e.makeTable("test4",[{key:"id",type:"timeIdms",props:["pk"]},{key:"name",type:"string"}]),e.makeTable("test5",[{key:"id",type:"uuid",props:["pk"]},{key:"name",type:"string"}]),e.connect(t)}).then(function(){return new r.Promise(function(t,n){e.write("test",null,{name:"Test"},function(e){var r=i.equals(e,{name:"Test",id:1});i.myConsole.assert(r,"Test Auto Incriment Integer."),r?t():n(e)})})}).then(function(){return new r.Promise(function(t,n){e.write("test2",null,{name:"Test"},function(e){var r=e.id.match(/^\w{8}-\w{4}-\w{4}-\w{4}-\w{12}$/);i.myConsole.assert(r,"Test UUID."),r?t():n(e.id)})})}).then(function(){return new r.Promise(function(t,n){e.write("test3",null,{name:"Test"},function(e){var r=e.id.match(/^\w{10}-\w{1,5}$/);i.myConsole.assert(r,"Test timeId."),r?t():n(e.id)})})}).then(function(){return new r.Promise(function(t,n){e.write("test4",null,{name:"Test"},function(e){var r=e.id.match(/^\w{13}-\w{1,5}$/);i.myConsole.assert(r,"Test timeIdms."),r?t():n(e.id)})})}).then(function(){return new r.Promise(function(t,n){for(var r=[],s=0;s<20;s++)r.push(o.uuid());o.fastCHAIN(r,function(t,n,r){e.write("test5",t,{name:"Test"},r)}).then(function(){r.sort();var o=[];e.rangeRead("test5",function(t,e,n){o.push(t.id),n()},function(){var e=i.equals(o,r);i.myConsole.assert(e,"Test Sorted Primary Keys."),e?t():n({e:r,g:o})},void 0,void 0)})})}).then(function(){return new r.Promise(function(t,n){e.destroy(t)})})},e}();e.TestAdapter=s}).call(this,n(28))},function(t,e){var n,r,i=t.exports={};function o(){throw new Error("setTimeout has not been defined")}function s(){throw new Error("clearTimeout has not been defined")}function a(t){if(n===setTimeout)return setTimeout(t,0);if((n===o||!n)&&setTimeout)return n=setTimeout,setTimeout(t,0);try{return n(t,0)}catch(e){try{return n.call(null,t,0)}catch(e){return n.call(this,t,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:o}catch(t){n=o}try{r="function"==typeof clearTimeout?clearTimeout:s}catch(t){r=s}}();var u,c=[],f=!1,h=-1;function l(){f&&u&&(f=!1,u.length?c=u.concat(c):h=-1,c.length&&d())}function d(){if(!f){var t=a(l);f=!0;for(var e=c.length;e;){for(u=c,c=[];++h<e;)u&&u[h].run();h=-1,e=c.length}u=null,f=!1,function(t){if(r===clearTimeout)return clearTimeout(t);if((r===s||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(t);try{r(t)}catch(e){try{return r.call(null,t)}catch(e){return r.call(this,t)}}}(t)}}function p(t,e){this.fun=t,this.array=e}function y(){}i.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];c.push(new p(t,e)),1!==c.length||f||a(d)},p.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=y,i.addListener=y,i.once=y,i.off=y,i.removeListener=y,i.removeAllListeners=y,i.emit=y,i.prependListener=y,i.prependOnceListener=y,i.listeners=function(t){return[]},i.binding=function(t){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(t){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},function(t,e,n){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0});var n=0,r={},i=Array.prototype.slice,o="undefined"!=typeof window&&window.setImmediate?window.setImmediate:!(void 0===t||!t.setImmediate)&&t.setImmediate,s="undefined"!=typeof window&&window.postMessage&&window.addEventListener,a=function(t){return t[0].apply(null,i.call(t,1))};s&&window.addEventListener("message",function(t){var e,n=t.data;"string"==typeof n&&0===n.indexOf("setMsg")&&(e=r[n])&&(delete r[n],a(e))});e.setFast=o?function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];o(function(){a(t)})}:s?function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i=n++,o="setMsg"+i;return r[o]=t,window.postMessage(o,"*"),i}:function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];setTimeout(function(){a(t)},0)};var u=function(){},c=["R"],f=["F"],h=["P"],l=function(){function e(t){this.h=h,this.v=[],this.y=void 0,t!==u&&g(this,t)}return e.doPolyFill=function(){void 0!==t&&(t.Promise||(t.Promise=this)),"undefined"!=typeof window&&(window.Promise||(window.Promise=this))},e.prototype.catch=function(t){return this.then(function(){},t)},e.prototype.then=function(t,n){if("function"!=typeof t&&this.h===f||"function"!=typeof n&&this.h===c)return this;var r=new e(u);return this.h!==h?p(r,this.h===f?t:n,this.y):this.v.push(new d(r,t,n)),r},e.resolve=function(t){return t instanceof this?t:y.b(new e(u),t)},e.reject=function(t){return y.S(new e(u),t)},e.all=function(t){return new e(function(e,n){var r=[];if(t.length)for(var i=function(n,i,o){void 0!==o?r.push(o):r.push(i),r.length==t.length&&e(r)},o=function(e){t[e].then(function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];i(0,t,void 0)}).catch(function(t){i(0,void 0,t)})},s=0;s<t.length;s++)o(s);else e([])})},e.race=function(t){var n=this,r=t.length,i=!1,o=-1,s=new e(u);if(!1!==Array.isArray(t))return this.reject(new TypeError);function a(t){n.resolve(t).then(function(t){i||(i=!0,y.b(s,t))},function(t){i||(i=!0,y.S(s,t))})}if(!r)return this.resolve([]);for(;++o<r;)a(t[o]);return s},e}();e.Promise=l;var d=function(){function t(t,e,n){this.T=t,"function"==typeof e&&(this.O=e,this.k=this.M),"function"==typeof n&&(this.j=n,this.I=this._)}return t.prototype.k=function(t){y.b(this.T,t)},t.prototype.M=function(t){p(this.T,this.O,t)},t.prototype.I=function(t){y.S(this.T,t)},t.prototype._=function(t){p(this.T,this.j,t)},t}();function p(t,n,r){e.setFast(function(){var e;try{e=n.apply(null,r)}catch(e){return y.S(t,e)}return e===t?y.S(t,new TypeError):y.b(t,e),null})}e.N=d;var y=function(){function t(){}return t.b=function(e,n){var r=v(m,n),i=r.R,o=-1,s=e.v.length;if("error"===r.x)return t.S(e,r.R);if(i)g(e,i);else for(e.h=f,e.y=n;++o<s;)e.v[o].k(n);return e},t.S=function(t,e){t.h=c,t.y=e;for(var n=-1,r=t.v.length;++n<r;)t.v[n].I(e);return t},t}();function m(t){var e=t&&t.then;return!t||"object"!=typeof t&&"function"!=typeof t||"function"!=typeof e?null:function(){e.apply(t,arguments)}}function g(t,e){var n=!1;function r(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];n||(n=!0,y.S(t,e))}function i(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];n||(n=!0,y.b(t,e))}var o=v(function(){e(i,r)});"error"===o.x&&r(o.R)}function v(t,e){var n={x:null,R:null};try{n.R=t(e),n.x="success"}catch(t){n.x="error",n.R=t}return n}}).call(this,n(2))},function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.myConsole=Object.create(console,{assert:{value:function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if("undefined"==typeof window)try{console.assert.apply(console,[t,e].concat(n))}catch(t){console.error(t.stack)}else console.assert.apply(console,[t,e].concat(n))},configurable:!0,enumerable:!0,writable:!0}}),e.equals=function(t,e){var n=function(t,e){var r,i,o,s,a;if((r=toString.call(t))!==toString.call(e))return!1;switch(r){default:return t.valueOf()===e.valueOf();case"[object Number]":return e=+e,(t=+t)?t===e:t==t?1/t==1/e:e!=e;case"[object RegExp]":return t.source===e.source&&t.global===e.global&&t.ignoreCase===e.ignoreCase&&t.multiline===e.multiline&&t.lastIndex===e.lastIndex;case"[object Function]":return!1;case"[object Array]":if((i=t.length)!==e.length)return!1;for(;i--;)if(!((s=t[i])===(a=e[i])&&0!==s||n(s,a)))return!1;return!0;case"[object Object]":for(o in i=0,t)if(t.hasOwnProperty(o)){if(++i,(s=t[o])===(a=e[o])&&0!==s||n(s,a))continue;return!1}for(o in e)if(e.hasOwnProperty(o)&&--i<0)return!1;return!0}};return t===e&&0!==t||n(t,e)}},function(t,e,n){(function(t){Object.defineProperty(e,"__esModule",{value:!0});var r=n(1),i=n(4),o=n(5);e.Promise="undefined"!=typeof window&&window.Promise?window.Promise:void 0!==t&&t.Promise?t.Promise:r.Promise,e.stopWords=["a","about","after","all","also","am","an","and","andor","another","any","are","as","at","be","because","been","before","being","between","both","but","by","came","can","come","could","did","do","each","for","from","get","got","had","has","have","he","her","here","him","himself","his","how","i","if","in","into","is","it","like","make","many","me","might","more","most","much","must","my","never","now","of","on","only","or","other","our","out","over","said","same","see","should","since","some","still","such","take","than","that","the","their","them","then","there","these","they","this","those","through","to","too","under","up","very","was","way","we","well","were","what","where","which","while","who","with","would","you","your"],e.a=function(t){return t?JSON.parse(JSON.stringify(t)):null},e.fastCHAIN=function(t,n){return new e.Promise(function(e,i){if(t&&t.length){var o=[],s=!1,a=function(){if(o.length<t.length)n(t[o.length],o.length,function(t){o.push(t),o.length%100==0?r.setFast(a):a()},function(t){s=!0,i(t)});else{if(s)return;e(o)}};a()}else e([])})},e.fastRACE=function(t,n){return new e.Promise(function(e,r){if(t&&t.length){var i=!1,o=0,s=function(){o<t.length&&(n(t[o],o,function(t){i||(i=!0,e([t]))},function(t){i||(i=!0,r(t))}),o++,s())};s()}else e([])})},e.fastALL=function(t,n){return e.Promise.all((t||[]).map(function(t,r){return new e.Promise(function(e,i){n(t,r,e,i)})}))};var s="undefined"==typeof window?"":navigator.userAgent||"";e.isSafari=0!==s.length&&(/^((?!chrome|android).)*safari/i.test(s)||/iPad|iPhone|iPod/.test(s)&&!window.MSStream),e.isMSBrowser=0!==s.length&&(s.indexOf("MSIE ")>0||s.indexOf("Trident/")>0||s.indexOf("Edge/")>0),e.isAndroid=/Android/.test(s),e.random16Bits=function(){if("undefined"==typeof crypto)return Math.round(Math.random()*Math.pow(2,16));if(crypto.getRandomValues){var e=new Uint16Array(1);return crypto.getRandomValues(e),e[0]}return void 0!==t&&t.f.randomBytes?t.f.randomBytes(2).reduce(function(t,e){return e*t}):Math.round(Math.random()*Math.pow(2,16))},e.tokenizer=function(t,n,r,s,a){var u=function(t){return!t||1===String(t).length||-1!==e.stopWords.indexOf(t)},c=(s||"").toLowerCase().replace(/(\d+)\/(\d+)|(?:\d+(?:,\d+)*|\d+)(?:\.\d+)?/gim,function(t,e,n){return e||n?(parseInt(e)/parseInt(n)).toFixed(a||4):parseFloat(t.replace(/\,/gim,"")).toFixed(a||4)}).replace(/\-|\_|\[|\]|\(|\)|\{|\}|\r?\n|\r|\t/gim," ").replace(/[^\w\s]|(\d\.)/gim,"$1").replace(/\s+/g," ").split(" ");switch(r[1]){case"english":return c.map(function(t,e){return{i:e,o:t,w:isNaN(t)?u(t)?"":i(o(t)):t}});case"english-stem":return c.map(function(t,e){return{i:e,o:t,w:isNaN(t)?u(t)?"":o(t):t}});case"english-meta":return c.map(function(t,e){return{i:e,o:t,w:isNaN(t)?u(t)?"":i(t):t}})}return c.map(function(t,e){return{o:t,w:t,i:e}})},e.timeid=function(t){for(var n=Math.round((new Date).getTime()/(t?1:1e3)).toString();n.length<(t?13:10);)n="0"+n;return n+"-"+(e.random16Bits()+e.random16Bits()).toString(16)},e.intersect=function(t,e){return!(!t||!e)&&!(!t.length||!e.length)&&(t||[]).filter(function(t){return-1!==(e||[]).indexOf(t)}).length>0},e.uuid=function(){var t,n,r="";return[r,r,r,r,r,r,r,r].reduce(function(i,o,s){for(t=e.random16Bits(),n=3===s?4:4===s?(t%16&3|8).toString(16):r,t=t.toString(16);t.length<4;)t="0"+t;return i+([2,3,4,5].indexOf(s)>-1?"-":r)+(n+t).slice(0,4)},r)},e.hash=function(t){for(var e=5381,n=t.length;n;)e=33*e^t.charCodeAt(--n);return(e>>>0).toString(16)};var a={int:function(t){return t},uuid:e.uuid,timeId:function(){return e.timeid()},timeIdms:function(){return e.timeid(!0)}};e.generateID=function(t,e){return a[t]?a[t](e||1):""},e.cleanArgs=function(t,n){for(var r={},i=t.length;i--;){var o=t[i].split(":");o.length>1?r[o[0]]=e.cast(o[1],n[o[0]]||void 0):r[o[0]]=n[o[0]]||void 0}return r},e.isObject=function(t){return"[object Object]"===Object.prototype.toString.call(t)},e.cast=function(t,n){if("any"===t||"blob"===t)return n;var r=typeof n;if("undefined"===r||null===n)return n;var i={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;","`":"&#x60;","=":"&#x3D;"},o=function(t,n){switch(t){case"safestr":return o("string",n).replace(/[&<>"'`=\/]/gim,function(t){return i[t]});case"int":return"number"!==r||n%1!=0?parseInt(n||0):n;case"number":case"float":return"number"!==r?parseFloat(n||0):n;case"any[]":case"array":return Array.isArray(n)?n:[];case"uuid":case"timeId":case"timeIdms":case"string":return"string"!==r?String(n):n;case"object":case"obj":case"map":return e.isObject(n)?n:{};case"boolean":case"bool":return!0===n}return n},s=o(String(t||"").toLowerCase(),n);if(-1!==t.indexOf("[]")){var a=t.slice(0,t.lastIndexOf("[]"));return(n||[]).map(function(t){return e.cast(a,t)})}return void 0!==s?["int","float","number"].indexOf(t)>-1&&isNaN(s)?0:s:void 0},e.binarySearch=function(t,n,r,i){var o=r||0,s=i||t.length;if(t[o]>n)return o;if(t[s]<n)return s+1;var a=Math.floor((o+s)/2);return n===t[a]?a:s-1===o?s:n>t[a]?e.binarySearch(t,n,a,s):n<t[a]?e.binarySearch(t,n,o,a):s},e.removeDuplicates=function(t){if(!t.length)return[];for(var e=[t[0]],n=1;n<t.length;n++)t[n]!==t[n-1]&&e.push(t[n]);return e},e.deepFreeze=function(t){return Object.getOwnPropertyNames(t||{}).forEach(function(n){var r=t[n];"object"==typeof r&&null!==r&&(t[n]=e.deepFreeze(r))}),Object.freeze(t)},e.crowDistance=function(t,e,n,r,i){void 0===i&&(i=6371);var o=function(t){return t*(Math.PI/180)},s=o(n-t),a=o(r-e),u=Math.sin(s/2)*Math.sin(s/2)+Math.cos(o(t))*Math.cos(o(n))*Math.sin(a/2)*Math.sin(a/2);return i*(2*Math.atan2(Math.sqrt(u),Math.sqrt(1-u)))};var u={};e.objQuery=function(t,e,n){var r=function(t,e,n){return t[e]&&n?r(t,e+1,n[t[e]]):n},i=t+(n?"1":"0");if(u[i])return r(u[i],0,e);var o=[];if(o=t.indexOf("[")>-1?[].concat.apply([],t.split(".").map(function(t){return t.match(/([^\[]+)|\[([^\]]+)\]\[/gim)||t})).map(function(t){return t.replace(/\[|\]/gim,"")}):t.split("."),n){var s=o.shift()+"."+o.shift();o.unshift(s)}return u[i]=o,r(u[i],0,e)}}).call(this,n(2))}])});